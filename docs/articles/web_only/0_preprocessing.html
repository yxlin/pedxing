<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="pedxing">
<title>0. Experimental Protocol and Preprocessing • pedxing</title>
<script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../../pkgdown.js"></script><meta property="og:title" content="0. Experimental Protocol and Preprocessing">
<meta property="og:description" content="pedxing">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../../index.html">pedxing</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../../articles/web_only/0_preprocessing.html">0. Experimental Protocol and Preprocessing</a>
    <a class="dropdown-item" href="../../articles/web_only/1_glm.html">1. Multi-level Regression Models</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>0. Experimental Protocol and Preprocessing</h1>
                        <h4 data-toc-skip class="author">Yi-Shin
Lin</h4>
            
            <h4 data-toc-skip class="date">2022-11-14</h4>
      
      
      <div class="d-none name"><code>0_preprocessing.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="ethics">Ethics<a class="anchor" aria-label="anchor" href="#ethics"></a>
</h2>
<p>We submitted our research plan for ethics review on 21-01-21
(dd-mm-yy) and received an approval on 24-01-21. To protect personal
data, I smudged (private) email addresses in the document.</p>
<p>We submitted an amendment for this plan on 29-04-21, adding to
collect EEG data and to change the meeting method from on-line to
in-person laboratory visit. The EEG experiments were conducted between
08-06-21 to 03-09-21.</p>
<p>We recruited participants and ran EEG experiments, using the
facilities in the School of Psychology, so the research plans were
submitted by one of the co-authors affiliated with it.</p>
<p><img src="../../reference/figures/ethics.png" style="width:50.0%" alt="ethics1"><img src="../../reference/figures/ethics_eeg.png" style="width:50.0%" alt="ethics1"><img src="../../reference/figures/ethicsOK.png" style="width:50.0%" alt="ethics2"></p>
<p>I stored all raw data in a sub-folder, <em>tests/inst/extdata</em>
under the project folder, <em>pedxing</em>. The data in the first-level
<code>data</code> folder is a R binary, after collating all raw data
together, except EEG. Specifically, the former includes EEG data, which
have the size that is over the limit for an R package.</p>
<p>By organising a similar directory structure, one should be able to
replicate our analysis steps. We make available our <a href="https://zenodo.org/record/6759754" class="external-link">raw data</a> at a repository
hosted by zenodo. We are grateful to the OpenAIRE project which provides
this service free of charge. Please cite our work, if you use our data,
code and / or ideas. We provide them here also free, using GNU GPLv3
license.</p>
</div>
<div class="section level2">
<h2 id="participants-and-data">Participants and Data<a class="anchor" aria-label="anchor" href="#participants-and-data"></a>
</h2>
<p>This following code chunk logged the main R packages I used during
analysis. Sometimes, I call functions within a particular package by
using the symbol, <em>::</em> or <em>:::</em>, if they were not used
frequently.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pkg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ggplot2"</span>, <span class="st">"data.table"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">pkg</span>, <span class="va">require</span>, character.only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">wk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">.Platform</span><span class="op">$</span><span class="va">OS.type</span> <span class="op">==</span> <span class="st">"windows"</span>, </span>
<span>             <span class="fu">shortPathName</span><span class="op">(</span><span class="st">"F:/Documents/pedxing/"</span><span class="op">)</span>,</span>
<span>               <span class="st">"/media/yslin/Tui/projects/pedxing/"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">setwd</a></span><span class="op">(</span><span class="va">wk</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>In the behaviour experiment, we recruited 24 participants, using MS
Team. We hosted 24 on-line meetings during 25-Feb-21 to 20-Apr-21. Four
participants dropped out before they finished the task. For instance,
participant, <em>HLBQ</em>, dropped out because he did not know how to
unzip the task file over 20 minutes.</p>
<p>Few participants did not fill in their age or handedness information
in the questionnaire we distributed. We found out the missing data after
starting data analyses, because of the protocol requiring the analysis
must start after the recruitment. We did analyse two pilot participants
as a review of the research plan, including the experimental procedure
and the analysis plan. The NA’s in the following code reflected the
missing data. mkKT did not show up at the appointment time.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sNme_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>sq <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">24</span>,</span>
<span>                   s <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"P4jJ"</span>, <span class="st">"mNoy"</span>, <span class="st">"Dndk"</span>, <span class="st">"Bhix"</span>, <span class="st">"69WA"</span>, <span class="st">"wLu7"</span>,</span>
<span>                         <span class="st">"B0kn"</span>, <span class="st">"HLBQ"</span>, <span class="st">"wXWs"</span>, <span class="st">"QU2L"</span>,<span class="st">"52ho"</span>, <span class="st">"wToD"</span>,</span>
<span>                         <span class="st">"YSlV"</span>, <span class="st">"VFFt"</span>, <span class="st">"amug"</span>, <span class="st">"qlNp"</span>, <span class="st">"LG2o"</span>, <span class="st">"OcQN"</span>,</span>
<span>                         <span class="st">"Jv1V"</span>, <span class="st">"zFpL"</span>, <span class="st">"PjiE"</span>, <span class="st">"5NNB"</span>, <span class="st">"OEWy"</span>, <span class="st">"mkKt"</span><span class="op">)</span>,</span>
<span>                   sex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"female"</span>, <span class="st">"male"</span>, <span class="st">"male"</span>, <span class="st">"female"</span>, <span class="st">"male"</span>,</span>
<span>                           <span class="st">"female"</span>, <span class="st">"male"</span>, <span class="st">"male"</span>, <span class="st">"female"</span>, <span class="st">"male"</span>,</span>
<span>                           <span class="st">"male"</span>, <span class="st">"female"</span>, <span class="st">"female"</span>, <span class="st">"male"</span>, <span class="st">"female"</span>,</span>
<span>                           <span class="st">"female"</span>, <span class="st">"female"</span>, <span class="st">"female"</span>, <span class="st">"female"</span>, <span class="st">"male"</span>,</span>
<span>                           <span class="st">"female"</span>,<span class="st">"male"</span>, <span class="st">"female"</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>                   age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">22</span>, <span class="fl">41</span>, <span class="fl">47</span>, <span class="fl">38</span>, <span class="fl">27</span>,  <span class="fl">48</span>,</span>
<span>                           <span class="fl">28</span>, <span class="fl">22</span>, <span class="fl">45</span>, <span class="cn">NA</span>, <span class="fl">44</span>, <span class="fl">40</span>,</span>
<span>                           <span class="fl">44</span>, <span class="fl">26</span>, <span class="fl">51</span>, <span class="fl">48</span>, <span class="fl">32</span>, <span class="fl">22</span>,</span>
<span>                           <span class="fl">37</span>, <span class="fl">64</span>, <span class="fl">40</span>, <span class="fl">38</span>, <span class="fl">51</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>                   handedness <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'r'</span>, <span class="st">'r'</span>, <span class="st">'r'</span>, <span class="st">'r'</span>, <span class="st">'r'</span>, <span class="st">'l'</span>,</span>
<span>                                  <span class="st">'r'</span>, <span class="st">'r'</span>, <span class="st">'r'</span>, <span class="cn">NA</span>, <span class="st">'r'</span>, <span class="st">'r'</span>,</span>
<span>                                  <span class="st">'r'</span>, <span class="st">'r'</span>, <span class="st">'r'</span>, <span class="st">'r'</span>, <span class="st">'r'</span>, <span class="st">'l'</span>,</span>
<span>                                  <span class="st">'r'</span>, <span class="st">'r'</span>, <span class="st">'r'</span>, <span class="st">'r'</span>, <span class="st">'r'</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dropout_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">8</span>, <span class="fl">23</span>, <span class="fl">24</span><span class="op">)</span></span>
<span><span class="va">discard_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">10</span>, <span class="fl">16</span><span class="op">)</span></span>
<span><span class="va">valid_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">7</span>, <span class="fl">9</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">14</span>, <span class="fl">15</span>, <span class="fl">17</span>, <span class="fl">18</span>, <span class="fl">19</span>, <span class="fl">20</span>, <span class="fl">21</span>, <span class="fl">22</span><span class="op">)</span></span>
<span><span class="va">sNme_exp</span><span class="op">[</span><span class="va">dropout_exp</span>, <span class="op">]</span></span>
<span><span class="va">sNme_exp</span><span class="op">[</span><span class="va">discard_exp</span>, <span class="op">]</span></span>
<span><span class="va">sNme_exp</span><span class="op">[</span><span class="va">valid_exp</span>, <span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">discard_exp</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sNme_exp</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">dropout_exp</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># 0.25</span></span></code></pre></div>
<p>Note we recruited participants in our first experiment when UK
residents were under a strict lock-down order, so our procedure had to
accommodate this. This contributes to the result that we have to exclude
a good number of participants. A table below detailed the reasons that
why we must exclude them.</p>
<div class="section level3">
<h3 id="on-line-experiments">On-line Experiments<a class="anchor" aria-label="anchor" href="#on-line-experiments"></a>
</h3>
<p><img src="../../reference/figures/drop1.png" style="width:50.0%" alt="p1"><img src="../../reference/figures/drop2.png" style="width:50.0%" alt="p2"><img src="../../reference/figures/drop3.png" style="width:50.0%" alt="p2"></p>
<p>At the end, we had to drop 4 participants who had not finished or
even had not started the task, and discard 5 participants (5 in 20).
This resulted in a discard rate of 25%. This rate is, although high, not
unexpected considering the circumstance and using on-line meeting to
recruit participants. This includes one participant who, when she was
interviewed after her practice trials, insisted that she has decided to
cross the road only after the car passed, a strategy that our
instruction does not encourage. We excluded her for this reason,
considering her not following the task instruction. The instruction
encouraged participants to make pre-car responses when it is
possible.</p>
<p>Note it would contradict the research aim if we recruited
participants who decide what responses he / she is going to make, prior
viewing the imperative stimulus. Importantly, we randomly presented the
four TTA conditions and the timing of TTAs at each trial was moved
slightly by adding a number drawn from <span class="math inline">\(Unif(-0.1, 0.1)\)</span>. The above two tables
logged the detailed reasons to discard these participants. I logged the
information immediately after the meetings.</p>
<p>The following tables are the analysed participants from the
behavioural study.</p>
<p><img src="../../reference/figures/ok1.png" style="width:50.0%" alt="p3"><img src="../../reference/figures/ok2.png" style="width:50.0%" alt="p4"></p>
</div>
<div class="section level3">
<h3 id="eeg-experiments">EEG Experiments<a class="anchor" aria-label="anchor" href="#eeg-experiments"></a>
</h3>
<p>In the EEG data set, the discard rate is 12.5%, slightly lower than
the behavioural data set. This data set was acquired after the lock-down
was lift. It was still at the time when people were generally wary of
disease transmission. We followed a strict experimental protocol taking
account of the circumstance. Specifically, we used a cleaning procedure
pre- and post-experiment and gowned up PPE. We implemented this
procedure as close to those did in NHS as we could possibly do. We also
restricted the time running the experiment to minimise contact time,
i.e., limiting ourselves the amount of time to install EEG
electrodes.</p>
<p><img src="../../reference/figures/subject_eeg1.png" style="width:50.0%" alt="p2"><img src="../../reference/figures/subject_eeg2.png" style="width:50.0%" alt="p2"><img src="../../reference/figures/subject_eeg4.png" style="width:50.0%" alt="p2"></p>
<p>Under this circumstance, we have to discard the three participants
because we could not attain good quality of EEG signals under a set time
limit. Although one might improve the efficiency of operating with full
PPE, this must take a certain amount of practice.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sNme_eeg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>sq <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">24</span>,</span>
<span>                       s <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'pG2u'</span>,<span class="st">'snv0'</span>,<span class="st">'rnd0'</span>,<span class="st">'NEd0'</span>,<span class="st">'HBfP'</span>,<span class="st">'xuzS'</span>, </span>
<span>                             <span class="st">'EtJa'</span>,<span class="st">'md0M'</span>,<span class="st">'2uqO'</span>,<span class="st">'4WWn'</span>,<span class="st">'pdLD'</span>,<span class="st">'lDHY'</span>,</span>
<span>                             <span class="st">'3maD'</span>,<span class="st">'5TtL'</span>,<span class="st">'7pve'</span>,<span class="st">'12UD'</span>,<span class="st">'w3ug'</span>,<span class="st">'bcKj'</span>,</span>
<span>                             <span class="st">'55tV'</span>,<span class="st">'I8BJ'</span>,<span class="st">'T4Vy'</span>,<span class="st">'JNvZ'</span>,<span class="st">'ulp9'</span>,<span class="st">'dDjo'</span><span class="op">)</span>,</span>
<span>                       sex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"female"</span>, <span class="st">'female'</span>, <span class="st">'male'</span>, <span class="st">'male'</span>, <span class="st">'female'</span>,<span class="st">'male'</span>,</span>
<span>                               <span class="st">'female'</span>, <span class="st">'male'</span>, <span class="st">'female'</span>, <span class="st">'male'</span>, <span class="st">'female'</span>,<span class="st">'male'</span>,</span>
<span>                               <span class="st">'male'</span>, <span class="st">'male'</span>, <span class="st">'female'</span>, <span class="st">'female'</span>, <span class="st">'female'</span>,<span class="st">'male'</span>,</span>
<span>                               <span class="st">'female'</span>, <span class="st">'female'</span>, <span class="st">'female'</span>, <span class="st">'female'</span>, <span class="st">'male'</span>, <span class="st">'male'</span><span class="op">)</span>,</span>
<span>                       age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">45</span>, <span class="fl">22</span>, <span class="fl">42</span>, <span class="fl">29</span>, <span class="fl">24</span>, <span class="fl">60</span>,</span>
<span>                               <span class="fl">61</span>, <span class="fl">19</span>, <span class="fl">53</span>, <span class="fl">19</span>, <span class="fl">35</span>, <span class="cn">NA</span>,</span>
<span>                               <span class="fl">47</span>, <span class="fl">28</span>, <span class="fl">26</span>, <span class="fl">28</span>, <span class="fl">38</span>, <span class="fl">19</span>,</span>
<span>                               <span class="fl">38</span>, <span class="fl">21</span>, <span class="fl">19</span>, <span class="fl">62</span>, <span class="fl">22</span>, <span class="fl">41</span><span class="op">)</span>,</span>
<span>                       handedness <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'r'</span>, <span class="st">'r'</span>, <span class="st">'r'</span>, <span class="st">'r'</span>, <span class="st">'r'</span>, <span class="st">'r'</span>,</span>
<span>                                      <span class="st">'r'</span>, <span class="st">'r'</span>, <span class="st">'r'</span>, <span class="st">'r'</span>, <span class="st">'r'</span>, <span class="st">'r'</span>,</span>
<span>                                      <span class="st">'r'</span>, <span class="st">'r'</span>, <span class="st">'r'</span>, <span class="st">'r'</span>, <span class="st">'r'</span>, <span class="st">'r'</span>,</span>
<span>                                      <span class="st">'r'</span>, <span class="st">'r'</span>, <span class="st">'r'</span>, <span class="st">'r'</span>, <span class="st">'r'</span>, <span class="st">'r'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">discard_eeg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">8</span>, <span class="fl">9</span><span class="op">)</span></span>
<span><span class="va">valid_eeg</span> <span class="op">&lt;-</span> <span class="va">sNme_eeg</span><span class="op">$</span><span class="va">sq</span><span class="op">[</span><span class="op">-</span><span class="va">discard_eeg</span><span class="op">]</span></span>
<span></span>
<span><span class="fl">3</span><span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sNme_eeg</span><span class="op">)</span></span>
<span><span class="co">## 0.125</span></span></code></pre></div>
<p>We have an almost equal male and female participants. The numbers of
participant in the age groups, 20-30, 30-40, … and 60-70, distribute
with the largest number in the first group, and gradually decrease. We
do have participants in all age groups up to 64 years old. So we can
state that our data represent not just the student/academic group. We
are very grateful to our participants who are willing to take part
during the difficult time, especially those in the upper age groups who
might risk their life.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dtmp0</span> <span class="op">&lt;-</span> <span class="va">sNme_exp</span><span class="op">[</span><span class="va">valid_exp</span>, <span class="op">]</span></span>
<span><span class="va">dtmp1</span> <span class="op">&lt;-</span> <span class="va">sNme_eeg</span><span class="op">[</span><span class="va">valid_eeg</span>, <span class="op">]</span></span>
<span><span class="va">dtmp0</span><span class="op">$</span><span class="va">exp</span> <span class="op">&lt;-</span> <span class="st">'exp'</span></span>
<span><span class="va">dtmp1</span><span class="op">$</span><span class="va">exp</span> <span class="op">&lt;-</span> <span class="st">'eeg'</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">dtmp0</span>, <span class="va">dtmp1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dage</span> <span class="op">&lt;-</span> <span class="fu">as_tibble</span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span>
<span><span class="va">dage</span><span class="op">$</span><span class="va">age_gp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">dage</span><span class="op">$</span><span class="va">age</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">30</span>, <span class="fl">40</span>, <span class="fl">50</span>, <span class="fl">60</span>, <span class="fl">70</span><span class="op">)</span>, right <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">dage</span><span class="op">$</span><span class="va">age_gp</span><span class="op">)</span></span>
<span><span class="co"># (20,30] (30,40] (40,50] (50,60] (60,70] </span></span>
<span><span class="co">#     11       9       7       2       3 </span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">age</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span>
<span><span class="co"># 19 64</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span></span>
<span><span class="co"># female   male </span></span>
<span><span class="co">#    20     16 </span></span></code></pre></div>
<p>We used a for loop to aggregate data together as a RData binary,
named <code>ped.rda</code>. In latter steps, we will repeatedly use this
binary file.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">E</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'exp'</span>, <span class="st">'eeg'</span><span class="op">)</span></span>
<span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tests/inst/extdata/exp/valid/"</span>, <span class="st">"tests/inst/extdata/eeg/valid/"</span><span class="op">)</span> </span>
<span><span class="va">ns0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">path</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>; <span class="va">ns0</span></span>
<span><span class="va">ns1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">path</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>; <span class="va">ns1</span></span>
<span></span>
<span><span class="va">fn</span> <span class="op">&lt;-</span> <span class="st">"Commotions_Output_1.csv"</span></span>
<span><span class="va">sNme</span> <span class="op">&lt;-</span> <span class="va">d</span><span class="op">$</span><span class="va">s</span>; <span class="va">sNme</span></span>
<span><span class="co">## Participation sequence</span></span>
<span><span class="co">##  [1] "mNoy" "Bhix" "B0kn" "wXWs" "52ho" "WtoD" "YSIV" "VFFt" "amug" "LG2o"</span></span>
<span><span class="co">## [11] "OcQN" "Jv1V" "zFpL" "PjiE" "5NNB"</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## Alphanumeric order</span></span>
<span><span class="co">##  [1] "52ho" "5NNB" "amug" "B0kn" "Bhix" "Jv1V" "LG2o" "mNoy" "OcQN" "PjiE"</span></span>
<span><span class="co">## [11] "VFFt" "wToD" "wXWs" "YSlV" "zFpL"</span></span>
<span></span>
<span><span class="va">tmpNme</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Participant"</span>, <span class="st">"Trial"</span>, <span class="st">"TTA"</span>, <span class="st">"Jitter"</span>, <span class="st">"Side"</span>, <span class="st">"signalDelay"</span>,</span>
<span>            <span class="st">"TrialStartTime"</span>, <span class="st">"CarAppearingTime"</span>, <span class="st">"CrossingkeyPressedTime"</span>, </span>
<span>            <span class="st">"Hit"</span>, <span class="st">"OtherKeyPressedTime"</span>, <span class="st">"FirstKeyPressed"</span>, <span class="st">"AvgFPS"</span><span class="op">)</span></span>
<span><span class="va">d0</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'tests/inst/extdata/'</span>, <span class="va">E</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">'/valid/'</span><span class="op">)</span>    </span>
<span>    <span class="va">sNme</span> <span class="op">&lt;-</span> <span class="va">d</span><span class="op">[</span><span class="va">exp</span> <span class="op">==</span> <span class="va">E</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">s</span></span>
<span>    <span class="va">ns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">sNme</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">ns</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">dfile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">path</span>, <span class="va">sNme</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>,<span class="st">"/"</span>,<span class="va">fn</span><span class="op">)</span>; <span class="va">dfile</span></span>
<span>        </span>
<span>        <span class="co"># This prints a figure to check over whether Unity results in correct </span></span>
<span>        <span class="co"># delay time jitter.</span></span>
<span>        <span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">path</span>, <span class="va">sNme</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, <span class="st">'/result_bk.ps'</span><span class="op">)</span> </span>
<span>        <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu">default_result</span><span class="op">(</span>fn <span class="op">=</span> <span class="va">fn</span>, path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">path</span>, <span class="va">sNme</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                              output <span class="op">=</span> <span class="va">output</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>    </span>
<span>        </span>
<span>        <span class="va">dtmp</span> <span class="op">&lt;-</span> <span class="fu">fread</span><span class="op">(</span><span class="va">dfile</span><span class="op">)</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dtmp</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">tmpNme</span></span>
<span>    </span>
<span>        <span class="va">dtmp</span><span class="op">$</span><span class="va">s</span> <span class="op">&lt;-</span> <span class="va">d</span><span class="op">[</span><span class="va">s</span> <span class="op">==</span> <span class="va">sNme</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">sq</span></span>
<span>        <span class="va">dtmp</span><span class="op">$</span><span class="va">age</span> <span class="op">&lt;-</span> <span class="va">d</span><span class="op">[</span><span class="va">s</span> <span class="op">==</span> <span class="va">sNme</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">age</span></span>
<span>        <span class="va">dtmp</span><span class="op">$</span><span class="va">sex</span> <span class="op">&lt;-</span> <span class="va">d</span><span class="op">[</span><span class="va">s</span> <span class="op">==</span> <span class="va">sNme</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">sex</span></span>
<span>        </span>
<span>        <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="va">d</span><span class="op">[</span><span class="va">s</span> <span class="op">==</span> <span class="va">sNme</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">s</span> <span class="op">==</span> <span class="va">sNme</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Subject name mismatched"</span><span class="op">)</span></span>
<span>        </span>
<span>        <span class="va">dtmp</span><span class="op">$</span><span class="va">sNme</span> <span class="op">&lt;-</span> <span class="va">sNme</span><span class="op">[</span><span class="va">j</span><span class="op">]</span></span>
<span>        <span class="va">dtmp</span><span class="op">$</span><span class="va">exp</span> <span class="op">&lt;-</span> <span class="va">E</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>        </span>
<span>        <span class="va">d0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">d0</span>, <span class="va">dtmp</span><span class="op">[</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">18</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span>    </span>
<span></span>
<span><span class="co">## d0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">d0</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Trial"</span>, <span class="st">"TTA"</span>, <span class="st">"Jitter"</span>,  <span class="st">"Side"</span>, <span class="st">"Delay"</span>, <span class="st">"TrialStartTime"</span>, </span>
<span>  <span class="st">"CarAppearingTime"</span>, <span class="st">"CrossingkeyPressedTime"</span>, <span class="st">"Hit"</span>, <span class="st">"OtherKeyPressedTime"</span>,</span>
<span>  <span class="st">"FirstKeyPressed"</span>, <span class="st">"AvgFPS"</span>,  <span class="st">"s"</span>, <span class="st">"age"</span>, <span class="st">"sex"</span>, <span class="st">"sNme"</span>, <span class="st">"E"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#### Rename columns ---------------------------</span></span>
<span><span class="va">d0</span><span class="op">$</span><span class="va">BeforeCarPassed</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">d0</span><span class="op">$</span><span class="va">CrossingkeyPressedTime</span> <span class="op">-</span> <span class="va">d0</span><span class="op">$</span><span class="va">CarAppearingTim</span><span class="op">)</span> <span class="op">&lt;</span> <span class="op">(</span><span class="va">d0</span><span class="op">$</span><span class="va">TTA</span> <span class="op">+</span> <span class="va">d0</span><span class="op">$</span><span class="va">Jitter</span><span class="op">)</span></span>
<span><span class="va">d0</span><span class="op">$</span><span class="va">RT</span> <span class="op">&lt;-</span> <span class="va">d0</span><span class="op">$</span><span class="va">CrossingkeyPressedTime</span> <span class="op">-</span> <span class="va">d0</span><span class="op">$</span><span class="va">CarAppearingTim</span></span>
<span><span class="va">d0</span><span class="op">$</span><span class="va">TTANme</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">d0</span><span class="op">$</span><span class="va">TTA</span><span class="op">)</span></span>
<span><span class="va">d0</span><span class="op">$</span><span class="va">Side</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">d0</span><span class="op">$</span><span class="va">Side</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># These two lines show a possible timing imprecision in Unity software</span></span>
<span><span class="co"># d0$RT0 &lt;- d0$CrossingkeyPressedTime - (d0$TrialStartTime + d0$signalDelay)</span></span>
<span><span class="co"># d0$RT1 &lt;- d0$CrossingkeyPressedTime - (d0$CarAppearingTim)</span></span>
<span></span>
<span><span class="va">d0</span><span class="op">$</span><span class="va">R</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">d0</span><span class="op">$</span><span class="va">Hit</span>, <span class="st">"hit"</span>, <span class="st">"safe"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">d0</span><span class="op">$</span><span class="va">C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/logical.html" class="external-link">as.logical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">d0</span><span class="op">$</span><span class="va">Hit</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># levels(d0$TTANme)</span></span>
<span></span>
<span><span class="va">d0</span><span class="op">$</span><span class="va">G</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">d0</span><span class="op">$</span><span class="va">BeforeCarPassed</span>, <span class="st">"before"</span>, <span class="st">"after"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">d0</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Trial'</span>, <span class="st">'Jitter'</span>,<span class="st">"BeforeCarPassed"</span>, <span class="st">"E"</span>, <span class="st">'TTA'</span>, <span class="st">'Side'</span>,<span class="st">'R'</span>, <span class="st">'C'</span>,</span>
<span>              <span class="st">'G'</span>, <span class="st">'TTANme'</span>, <span class="st">'RT'</span>, <span class="st">'s'</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">dat</span><span class="op">[</span><span class="va">E</span> <span class="op">==</span> <span class="st">"exp"</span>, <span class="va">.N</span>, <span class="fu">.</span><span class="op">(</span><span class="va">s</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">dat</span><span class="op">[</span><span class="va">E</span> <span class="op">==</span> <span class="st">"exp"</span>, <span class="va">.N</span>, <span class="fu">.</span><span class="op">(</span><span class="va">s</span>, <span class="va">TTA</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">dat</span><span class="op">[</span><span class="va">E</span> <span class="op">==</span> <span class="st">"eeg"</span>, <span class="va">.N</span>, <span class="fu">.</span><span class="op">(</span><span class="va">s</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">dat</span><span class="op">[</span><span class="va">E</span> <span class="op">==</span> <span class="st">"eeg"</span>, <span class="va">.N</span>, <span class="fu">.</span><span class="op">(</span><span class="va">s</span>, <span class="va">TTA</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co">## Add D and DTTA columns for legacy code</span></span>
<span><span class="va">dat</span><span class="op">$</span><span class="va">D</span> <span class="op">&lt;-</span> <span class="fl">40</span> </span>
<span><span class="va">dat</span><span class="op">$</span><span class="va">Side</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">Side</span><span class="op">)</span></span>
<span><span class="va">dat</span><span class="op">$</span><span class="va">DTTA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">D</span>, <span class="st">"-"</span>, <span class="va">dat</span><span class="op">$</span><span class="va">TTA</span><span class="op">)</span>, </span>
<span>                   levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'40-2.5'</span>, <span class="st">'40-3'</span>, <span class="st">'40-3.5'</span>, <span class="st">'40-4'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat</span><span class="op">[</span><span class="va">E</span> <span class="op">==</span> <span class="st">"exp"</span>, <span class="va">.N</span>, <span class="fu">.</span><span class="op">(</span><span class="va">TTA</span>, <span class="va">s</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">dat</span><span class="op">[</span><span class="va">E</span> <span class="op">==</span> <span class="st">"eeg"</span>, <span class="va">.N</span>, <span class="fu">.</span><span class="op">(</span><span class="va">TTA</span>, <span class="va">s</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>The following is to format the data to enable <em>RStan</em> software
to process.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">valid_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">7</span>, <span class="fl">9</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">14</span>, <span class="fl">15</span>, <span class="fl">17</span>, <span class="fl">18</span>, <span class="fl">19</span>, <span class="fl">20</span>, <span class="fl">21</span>, <span class="fl">22</span><span class="op">)</span></span>
<span><span class="va">valid_eeg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">7</span>, <span class="fl">10</span><span class="op">:</span><span class="fl">24</span><span class="op">)</span></span>
<span><span class="va">dexp</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="va">E</span> <span class="op">==</span> <span class="st">"exp"</span> <span class="op">&amp;</span> <span class="va">s</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">valid_exp</span><span class="op">]</span></span>
<span><span class="va">deeg</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="va">E</span> <span class="op">==</span> <span class="st">"eeg"</span> <span class="op">&amp;</span> <span class="va">s</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">valid_eeg</span><span class="op">]</span></span>
<span></span>
<span><span class="va">dexp</span><span class="op">$</span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">dexp</span><span class="op">$</span><span class="va">s</span>, levels <span class="op">=</span> <span class="va">valid_exp</span><span class="op">)</span></span>
<span><span class="va">deeg</span><span class="op">$</span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">deeg</span><span class="op">$</span><span class="va">s</span>, levels <span class="op">=</span> <span class="va">valid_eeg</span><span class="op">)</span></span>
<span><span class="va">dexp</span><span class="op">$</span><span class="va">snew</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dexp</span><span class="op">$</span><span class="va">s</span>, <span class="va">dexp</span><span class="op">$</span><span class="va">E</span><span class="op">)</span></span>
<span><span class="va">deeg</span><span class="op">$</span><span class="va">snew</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">deeg</span><span class="op">$</span><span class="va">s</span>, <span class="va">deeg</span><span class="op">$</span><span class="va">E</span><span class="op">)</span></span>
<span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">dexp</span>, <span class="va">deeg</span><span class="op">)</span></span>
<span><span class="va">d</span><span class="op">$</span><span class="va">TTANme</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">TTANme</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.5</span>, <span class="fl">3</span>, <span class="fl">3.5</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">d</span><span class="op">$</span><span class="va">sold</span> <span class="op">&lt;-</span> <span class="va">d</span><span class="op">$</span><span class="va">s</span></span>
<span><span class="va">d</span><span class="op">$</span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">snew</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="fu">setorder</span><span class="op">(</span><span class="va">d</span>, <span class="va">s</span>, <span class="va">TTA</span>, <span class="va">Side</span>, <span class="va">G</span>, <span class="va">R</span><span class="op">)</span></span>
<span></span>
<span><span class="va">d</span><span class="op">$</span><span class="va">TTAint</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">TTA</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span> <span class="op">)</span></span>
<span><span class="va">d</span><span class="op">$</span><span class="va">side</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">Side</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span> <span class="op">)</span></span>
<span><span class="va">d</span><span class="op">$</span><span class="va">TTAint</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">TTA</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span> <span class="op">)</span></span>
<span><span class="va">d</span><span class="op">$</span><span class="va">side</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">Side</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span> <span class="op">)</span></span>
<span></span>
<span><span class="co">## dat reduces columns</span></span>
<span><span class="co">## d0 has all the columns</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">d0</span>, <span class="va">dat</span>, <span class="va">d</span>, file <span class="op">=</span> <span class="st">"data/ped.rda"</span><span class="op">)</span></span>
<span><span class="co"># tools::resaveRdaFiles("data/ped.rda", compress = "xz",</span></span>
<span><span class="co">#                          compression_level = 9)</span></span>
<span><span class="co"># see R documentation "ped" for description of the dataset</span></span></code></pre></div>
<p>Lastly, we showed the two abnormal responses and investigated the
reason behind why they appeared.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#### Two abnormal responses -------------------------------------------</span></span>
<span><span class="co">## Road width: 4.2m</span></span>
<span><span class="co">## Initial distance from Kerb: 0.5 m</span></span>
<span><span class="co">## Car Length: 4.96 m</span></span>
<span><span class="co">## Car Width: 1.9 m</span></span>
<span><span class="co">## Car initial distance: 40 m</span></span>
<span><span class="va">dtmp0</span> <span class="op">&lt;-</span> <span class="va">d0</span><span class="op">[</span><span class="va">d0</span><span class="op">$</span><span class="va">sNme</span> <span class="op">==</span> <span class="st">"Bhix"</span> <span class="op">&amp;</span> <span class="va">d0</span><span class="op">$</span><span class="va">Trial</span> <span class="op">==</span> <span class="fl">28</span> <span class="op">&amp;</span> <span class="va">d0</span><span class="op">$</span><span class="va">TTA</span> <span class="op">==</span> <span class="fl">2.5</span>,<span class="op">]</span></span>
<span><span class="va">dtmp1</span> <span class="op">&lt;-</span> <span class="va">d0</span><span class="op">[</span><span class="va">d0</span><span class="op">$</span><span class="va">sNme</span> <span class="op">==</span> <span class="st">"VFFt"</span> <span class="op">&amp;</span> <span class="va">d0</span><span class="op">$</span><span class="va">Trial</span> <span class="op">==</span> <span class="fl">17</span> <span class="op">&amp;</span> <span class="va">d0</span><span class="op">$</span><span class="va">TTA</span> <span class="op">==</span> <span class="fl">2.5</span> <span class="op">&amp;</span> <span class="va">d0</span><span class="op">$</span><span class="va">Delay</span> <span class="op">==</span> <span class="fl">3</span>, <span class="op">]</span></span>
<span><span class="va">dtmp2</span> <span class="op">&lt;-</span> <span class="va">d0</span><span class="op">[</span><span class="va">d0</span><span class="op">$</span><span class="va">sNme</span> <span class="op">==</span> <span class="st">"Bhix"</span> <span class="op">&amp;</span> <span class="va">d0</span><span class="op">$</span><span class="va">Trial</span> <span class="op">==</span> <span class="fl">27</span> <span class="op">&amp;</span> <span class="va">d0</span><span class="op">$</span><span class="va">TTA</span> <span class="op">==</span> <span class="fl">2.5</span>,<span class="op">]</span></span>
<span><span class="va">dtmp3</span> <span class="op">&lt;-</span> <span class="va">d0</span><span class="op">[</span><span class="va">d0</span><span class="op">$</span><span class="va">sNme</span> <span class="op">==</span> <span class="st">"Bhix"</span> <span class="op">&amp;</span> <span class="va">d0</span><span class="op">$</span><span class="va">Trial</span> <span class="op">==</span> <span class="fl">24</span> <span class="op">&amp;</span> <span class="va">d0</span><span class="op">$</span><span class="va">TTA</span> <span class="op">==</span> <span class="fl">2.5</span>,<span class="op">]</span></span>
<span></span>
<span><span class="va">time2pass</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">4.2</span><span class="op">+</span><span class="fl">.5</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1.6</span>  </span>
<span><span class="va">car2pass</span> <span class="op">&lt;-</span> <span class="fl">4.96</span> <span class="op">/</span> <span class="fl">40</span></span>
<span><span class="va">dtmp0</span><span class="op">$</span><span class="va">CarAppearingTime</span> <span class="op">+</span> <span class="va">dtmp0</span><span class="op">$</span><span class="va">TTA</span> <span class="op">+</span> <span class="va">dtmp0</span><span class="op">$</span><span class="va">Jitter</span></span>
<span><span class="va">dtmp0</span><span class="op">$</span><span class="va">CrossingkeyPressedTime</span> </span>
<span></span>
<span><span class="va">dtmp1</span><span class="op">$</span><span class="va">CarAppearingTime</span> <span class="op">+</span> <span class="va">dtmp1</span><span class="op">$</span><span class="va">TTA</span> <span class="op">+</span> <span class="va">dtmp1</span><span class="op">$</span><span class="va">Jitter</span></span>
<span><span class="va">dtmp1</span><span class="op">$</span><span class="va">CrossingkeyPressedTime</span> </span>
<span></span>
<span><span class="va">dtmp2</span><span class="op">$</span><span class="va">CarAppearingTime</span> <span class="op">+</span> <span class="va">dtmp2</span><span class="op">$</span><span class="va">TTA</span> <span class="op">+</span> <span class="va">dtmp2</span><span class="op">$</span><span class="va">Jitter</span></span>
<span><span class="va">dtmp2</span><span class="op">$</span><span class="va">CrossingkeyPressedTime</span> </span>
<span></span>
<span><span class="va">dtmp3</span><span class="op">$</span><span class="va">CarAppearingTime</span> <span class="op">+</span> <span class="va">dtmp3</span><span class="op">$</span><span class="va">TTA</span> <span class="op">+</span> <span class="va">dtmp3</span><span class="op">$</span><span class="va">Jitter</span></span>
<span><span class="va">dtmp3</span><span class="op">$</span><span class="va">CrossingkeyPressedTime</span> </span>
<span></span>
<span><span class="co">## Conclusion: According to the Unity programmer, Unity </span></span>
<span><span class="co">## represents the pedestrian and car by using cylinders. Therefore, imprecision </span></span>
<span><span class="co">## representation might be the reason causing these two abnormal responses. </span></span></code></pre></div>
<p>This concludes the preprocessing step. Next I load
<code>pedxing</code> package, which will automatically bring in
<em>ped.rda</em>.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Yi-Shin Lin.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
