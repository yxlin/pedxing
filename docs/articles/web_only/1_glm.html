<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="pedxing">
<title>1. Multi-level Regression Models • pedxing</title>
<script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../../pkgdown.js"></script><meta property="og:title" content="1. Multi-level Regression Models">
<meta property="og:description" content="pedxing">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../../index.html">pedxing</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../../articles/web_only/0_preprocessing.html">0. Experimental Protocol and Preprocessing</a>
    <a class="dropdown-item" href="../../articles/web_only/1_glm.html">1. Multi-level Regression Models</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>1. Multi-level Regression Models</h1>
                        <h4 data-toc-skip class="author">Yi-Shin
Lin<sup>1</sup>, Corresponding Author<sup>1,*</sup>
</h4>
            
            <h4 data-toc-skip class="date">2022-11-14</h4>
      
      
      <div class="d-none name"><code>1_glm.Rmd</code></div>
    </div>

    
    
<p>My first aim here is to test whether the left-versus-right (denoted
LR, or L for short) factor has no influence, as suggested by the pilot
data. We have not found a 100% identical procedure in literature testing
this factor. A possible reference-able study employed participant actors
to cross roads in 6 different intersections or road blocks. What they
did is more similar to naturalistic observations, instead of a highly
controlled laboratory-based experiment (which we did). They had not
found any difference in left-versus-right preference in the variables
they examined using nested logit models <span class="citation">(Chu et
al., 2004)</span>. Thus, together with our pilot data, we have no strong
reason to believe that the LR factor will have a significant impact on
dependent variables. To check this hypothesis, we tested it in the full
data set to establish, also in our case, the LR factor has no
significant impact and therefore we can safely aggregate trials across
the two levels in the LR factor.</p>
<p>My second aim is to test the main, research factor, the
time-to-arrival, denoted TTA. I assume that this factor results in a
time pressure build-up and correspondingly unobservable signal
suppression. Here, my aim is to establish the foundation of the theory
mainly deduced from (naturalistic) observational studies [cite cite
cite] that TTA exerts strong influences on various traffic decisions,
including crossing roads that we tested here. That is, we seek to find a
piece of casual evidence in a highly controlled laboratory setting, in
contrast to correlation observations.</p>
<p>Our hypothesis is that decision makers engage mathematically exact
mental calculation on the arrival times and the assess how much time
left for him / her to walk cross a road. The calculation transcends
to</p>
<p>To account for such a process of signal suppression that we tested in
a, potentially, multi-phase decision process in a road-crossing task, in
psychological literature, we found two candidate cognitive theories /
models. First is to link two or multiple processes of evidence
accumulation [cite]. The multi-process model were tested in
target-switching tasks with two choices. These tasks change their
imperative stimuli to match an alternative target mid-trial, so the
models, notably the <code>piece-wise</code>, drift-diffusion and linear
accumulator, assume a first-stage process of evidence accumulation
switches direction, like the change of imperative stimulus, to match the
alternative choice. We call this theory, process changes. In this case,
the unobservable signal might look like suppression because the model
were designed around 2AFC task, but it is a result of accumulated
evidence going from an initial direction to the alternative.</p>
<p>Second is the stop-signal model, which assume, in a two-alternative
situation, a competing accumulator racing to stop an initiated
accumulator; hence, a seemingly inhibition process is observed. We will
use an ABC-based method <span class="citation">(Turner and Sederberg,
2014; Lin et al., 2019)</span> to test these alternatives and compare
them against the UM model in a next document that analyses plausible
cognitive process models. We will further test the assumption of
<em>unobservable pressure of signal suppression</em>, by examining the
P3 ERP component, which also recently been denoted as CPP and suggested
to have a causal connection between evidence accumulation and initiation
of a decision.</p>
<p>No matter which process models may account for the current data best,
we assume TTA must influence all dependent variables, because this is
what frequently observed in many naturalistic studies.</p>
<p>In addition, we further presume that participants must perceive the
imperative stimulus and estimate its arrival time by assessing its speed
(which is constant in the current task) and distance (which is obviously
dynamic) to the crossing zone. In the stage of conducting experiment, I
had excluded participants who used the strategy of always responding
after the car passes by interviewing them right after they finished
their practice session. Note our task instruction clearly states that,
if it is possible, participants should make responses before the car
passes.</p>
<p>An argument that some participants might still use the always-wait
strategy is to argue for that our data analysis should include
participants who do not follow the task instruction. This argument is
not in line with the result in the following analysis, either.</p>
<p>A preview of the summary result is that:</p>
<ol style="list-style-type: decimal">
<li>We found no compelling evidence supporting an influence due to the
LR factor.</li>
<li>We found strong evidence of TTA influence.</li>
</ol>
<p>In the following, I describe details about how I derive the above two
key results by employing multiple hierarchical Bayesian regression
models. The reader may jump to the end of the document to skip technical
details and see two figures presenting the highly condensed results.</p>
<div class="section level2">
<h2 id="model-based-analysis-of-manifest-responses">Model-based Analysis of Manifest Responses<a class="anchor" aria-label="anchor" href="#model-based-analysis-of-manifest-responses"></a>
</h2>
<p>I used logistic regression models to separately analyse six key
dependent variables:</p>
<ol style="list-style-type: decimal">
<li>the proportion of responses made before the car passes given that
they have not resulted in collisions,</li>
<li>the proportion of responses resulting in safe crosses given that
they are made <em>before</em> the car passes,</li>
<li>the proportion of responses resulting in safe crosses given that
they are made <em>after</em> the car passes,</li>
<li>Safe response times (RTs) from those responses made before the car
passes,</li>
<li>Safe RTs from those responses made after the car passes, and</li>
<li>Collision RTs from those made before the car passes</li>
</ol>
<p>I did not separately analyse the collision RTs after the car passes,
because in total there are only, respectively, 2, 0, 3, and 1 trials in
the four TTA conditions.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pkg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'data.table'</span>, <span class="st">'ggplot2'</span>, <span class="st">'rstan'</span>, <span class="st">'rethinking'</span>, <span class="st">'pedxing'</span>, <span class="st">'dplyr'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">pkg</span>, <span class="va">require</span>, character.only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span> <span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">wk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">.Platform</span><span class="op">$</span><span class="va">OS.type</span> <span class="op">==</span> <span class="st">"windows"</span>, </span>
<span>             <span class="fu">shortPathName</span><span class="op">(</span><span class="st">"E:/Documents/pedxing/"</span><span class="op">)</span>,</span>
<span>              <span class="st">'/media/yslin/Tui/projects/pedxing/'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">setwd</a></span><span class="op">(</span><span class="va">wk</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<p>I loaded the pre-processed data and selected key variables. I did a
few simple checks on the total number of trial to see whether it is as
the design intends it to be. Specifically, it should be 256 trials,
because we used (1) 2 levels in LR factor, 4 levels in TTA factor,
tested 4 blocks in a participant, repeated 8 times for each of the
unique set of treatment combinations.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ped</span><span class="op">)</span></span>
<span><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TTA"</span>,<span class="st">"Side"</span>,<span class="st">"R"</span>,<span class="st">"G"</span>,<span class="st">"TTANme"</span>,<span class="st">"RT"</span>,<span class="st">"s"</span>,<span class="st">"sold"</span>, <span class="st">"E"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">d</span><span class="op">[</span>,<span class="va">..cols</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">s</span><span class="op">)</span></span>
<span><span class="co">#   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19 </span></span>
<span><span class="co"># 256 256 256 256 256 256 256 256 256 256 256 256 256 256 256 256 256 256 256 </span></span>
<span><span class="co">#  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36 </span></span>
<span><span class="co"># 256 256 256 256 256 256 256 256 256 256 256 256 256 256 256 256 256 </span></span>
<span></span>
<span><span class="co">## ditto; should be all 64</span></span>
<span><span class="va">d</span><span class="op">[</span>, <span class="va">.N</span>, <span class="fu">.</span><span class="op">(</span><span class="va">E</span>, <span class="va">TTA</span>, <span class="va">s</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co">## should be 64</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">d</span><span class="op">[</span>, <span class="va">.N</span>, <span class="fu">.</span><span class="op">(</span><span class="va">E</span>, <span class="va">TTA</span>, <span class="va">s</span><span class="op">)</span><span class="op">]</span><span class="op">$</span><span class="va">N</span><span class="op">)</span></span></code></pre></div>
<p>Then I checked the number of collision response in each condition.
This depends on participants and conditions.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dhit</span> <span class="op">&lt;-</span> <span class="va">d</span><span class="op">[</span><span class="va">R</span><span class="op">==</span><span class="st">"hit"</span><span class="op">]</span> <span class="op">%&gt;%</span> <span class="fu">count</span><span class="op">(</span><span class="va">TTA</span>, <span class="va">G</span>, .drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>; </span>
<span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">dhit</span><span class="op">)</span></span>
<span><span class="co">#    TTA      G   n</span></span>
<span><span class="co"># 1: 2.5  after   2</span></span>
<span><span class="co"># 2: 2.5 before 752</span></span>
<span><span class="co"># 3: 3.0  after   0</span></span>
<span><span class="co"># 4: 3.0 before 213</span></span>
<span><span class="co"># 5: 3.5  after   3</span></span>
<span><span class="co"># 6: 3.5 before  17</span></span>
<span><span class="co"># 7: 4.0  after   1</span></span>
<span><span class="co"># 8: 4.0 before   6</span></span>
<span></span>
<span></span>
<span><span class="va">prohit</span> <span class="op">&lt;-</span> <span class="va">d</span><span class="op">[</span><span class="va">R</span> <span class="op">==</span> <span class="st">"hit"</span>, <span class="fu">.</span><span class="op">(</span>count <span class="op">=</span> <span class="va">.N</span>,</span>
<span>                           MRT <span class="op">=</span> <span class="fl">1000</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">RT</span><span class="op">)</span><span class="op">)</span>, <span class="fu">.</span><span class="op">(</span><span class="va">TTA</span>, <span class="va">Side</span>, <span class="va">G</span>, <span class="va">s</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">prohit</span><span class="op">[</span><span class="va">TTA</span> <span class="op">==</span> <span class="fl">2.5</span> <span class="op">&amp;</span> <span class="va">G</span> <span class="op">==</span> <span class="st">"before"</span><span class="op">]</span></span>
<span><span class="va">prohit</span><span class="op">[</span>, <span class="va">total</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span>, <span class="fu">.</span><span class="op">(</span><span class="va">TTA</span>, <span class="va">Side</span>, <span class="va">s</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">prohit</span><span class="op">[</span>, <span class="va">value</span> <span class="op">:=</span> <span class="va">count</span><span class="op">/</span><span class="va">total</span><span class="op">]</span></span>
<span><span class="fu">setorder</span><span class="op">(</span><span class="va">prohit</span>, <span class="va">TTA</span>, <span class="va">G</span>, <span class="va">Side</span>, <span class="va">s</span><span class="op">)</span></span>
<span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">prohit</span><span class="op">[</span><span class="va">TTA</span> <span class="op">==</span> <span class="fl">2.5</span> <span class="op">&amp;</span> <span class="va">G</span> <span class="op">==</span> <span class="st">"before"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co"># A tibble: 70 × 8</span></span>
<span><span class="co">#      TTA Side  G          s count   MRT total value</span></span>
<span><span class="co">#    &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;  &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#  1   2.5 left  before     1     8  591.     8     1</span></span>
<span><span class="co">#  2   2.5 left  before     2    18  556.    18     1</span></span>
<span><span class="co">#  3   2.5 left  before     3     7  793.     7     1</span></span>
<span><span class="co">#  4   2.5 left  before     4     3  622.     3     1</span></span>
<span><span class="co"># ...</span></span>
<span><span class="co"># … with 60 more rows</span></span></code></pre></div>
<div class="section level3">
<h3 id="response-proportion">Response Proportion<a class="anchor" aria-label="anchor" href="#response-proportion"></a>
</h3>
<p>The proportion of responses made before the car passes, especially at
the 3-s TTA, is indicative of that participants mostly followed the task
instruction. Specifically, we recorded only three safe responses in the
condition of 2.5-s TTA over 9216 trials. Within these three responses,
two show fast response times, that we can safely consider them as
anticipated responses. This speaks to the effectiveness of adding the
small random time variation [sampled from a <span class="math inline">\(U(-0.1, 0.1)\)</span>] to the TTA. The other one,
namely 821.9 ms, falls on the upper 10% percentile of the collision
responses in the 2.5-TTA condition. Therefore</p>
<p>So far, I found no clear explanation for this safe response, because
<code>correct</code>We Thus, any models optimising around, at least,
this dataset, will generate nearly pure model predictions, which reflect
only model assumptions for the safe responses at the 2.5 TTA
condition.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pro</span> <span class="op">&lt;-</span> <span class="va">d</span><span class="op">[</span><span class="va">R</span> <span class="op">==</span> <span class="st">"safe"</span>, <span class="fu">.</span><span class="op">(</span>count <span class="op">=</span> <span class="va">.N</span>,</span>
<span>                        MRT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">RT</span><span class="op">)</span><span class="op">)</span>, <span class="fu">.</span><span class="op">(</span><span class="va">TTA</span>, <span class="va">Side</span>, <span class="va">G</span>, <span class="va">s</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span>
<span><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Jitter"</span>, <span class="st">"RT"</span>, <span class="st">"G"</span>, <span class="st">"Side"</span>, <span class="st">"TTA"</span><span class="op">)</span></span>
<span><span class="va">d</span><span class="op">[</span><span class="va">TTA</span> <span class="op">==</span> <span class="fl">2.5</span> <span class="op">&amp;</span> <span class="va">G</span> <span class="op">==</span> <span class="st">"before"</span> <span class="op">&amp;</span> <span class="va">R</span> <span class="op">==</span> <span class="st">"safe"</span>, <span class="va">..cols</span><span class="op">]</span></span>
<span><span class="co">#     Jitter     RT      G  Side TTA</span></span>
<span><span class="co"># 1: 0.08506 0.8219 before  left 2.5</span></span>
<span><span class="co"># 2: 0.01145 0.1370 before right 2.5</span></span>
<span><span class="co"># 3: 0.01056 0.0400 before  left 2.5</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span> <span class="va">d</span><span class="op">[</span><span class="va">TTA</span> <span class="op">==</span> <span class="fl">2.5</span> <span class="op">&amp;</span> <span class="va">G</span> <span class="op">==</span> <span class="st">"before"</span> <span class="op">&amp;</span> <span class="va">R</span> <span class="op">==</span> <span class="st">"hit"</span>, <span class="va">..cols</span><span class="op">]</span><span class="op">$</span><span class="va">RT</span>, </span>
<span>          probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">.05</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">15</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span></span>
<span><span class="co">#    70%    75%    80%    85%    90%    95%   100% </span></span>
<span><span class="co"># 0.6574 0.6800 0.7168 0.7580 0.8029 0.8984 2.3650</span></span>
<span></span>
<span><span class="co">#    </span></span>
<span><span class="va">pro</span><span class="op">[</span><span class="va">TTA</span> <span class="op">==</span> <span class="fl">2.5</span> <span class="op">&amp;</span> <span class="va">G</span> <span class="op">==</span> <span class="st">"before"</span><span class="op">]</span></span>
<span><span class="co">#    TTA  Side      G  s count   MRT</span></span>
<span><span class="co"># 1: 2.5  left before 13     1 821.9</span></span>
<span><span class="co"># 2: 2.5  left before 18     1  40.0</span></span>
<span><span class="co"># 3: 2.5 right before 14     1 137.0</span></span></code></pre></div>
<p>I then prepare the data to the format that is suitable to
<em>RStan</em>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">s</span><span class="op">)</span><span class="op">)</span>; <span class="va">ns</span></span>
<span><span class="va">pro</span> <span class="op">&lt;-</span> <span class="va">d</span><span class="op">[</span><span class="va">R</span> <span class="op">==</span> <span class="st">"safe"</span>, <span class="fu">.</span><span class="op">(</span>count <span class="op">=</span> <span class="va">.N</span><span class="op">)</span>, <span class="fu">.</span><span class="op">(</span><span class="va">TTAint</span>, <span class="va">TTANme</span>, <span class="va">side</span>, <span class="va">G</span>, <span class="va">s</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">pro</span><span class="op">[</span><span class="va">TTAint</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">G</span> <span class="op">==</span> <span class="st">"before"</span><span class="op">]</span></span>
<span><span class="va">pro</span><span class="op">[</span>, <span class="va">total</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span>, <span class="fu">.</span><span class="op">(</span><span class="va">TTAint</span>, <span class="va">side</span>, <span class="va">s</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">pro</span><span class="op">[</span>, <span class="va">value</span> <span class="op">:=</span> <span class="va">count</span><span class="op">/</span><span class="va">total</span><span class="op">]</span></span>
<span><span class="va">dp_be</span> <span class="op">&lt;-</span> <span class="va">pro</span><span class="op">[</span><span class="va">G</span> <span class="op">==</span> <span class="st">"before"</span><span class="op">]</span> <span class="co">## pre-car  percentage</span></span>
<span><span class="va">dp_af</span> <span class="op">&lt;-</span> <span class="va">pro</span><span class="op">[</span><span class="va">G</span> <span class="op">==</span> <span class="st">"after"</span><span class="op">]</span> </span>
<span></span>
<span><span class="va">pro</span> <span class="op">&lt;-</span> <span class="va">d</span><span class="op">[</span><span class="va">G</span> <span class="op">==</span> <span class="st">"before"</span>, <span class="fu">.</span><span class="op">(</span>count <span class="op">=</span> <span class="va">.N</span><span class="op">)</span>, <span class="fu">.</span><span class="op">(</span><span class="va">TTAint</span>, <span class="va">TTANme</span>, <span class="va">side</span>, <span class="va">R</span>, <span class="va">s</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">pro</span><span class="op">[</span>, <span class="va">total</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span>, <span class="fu">.</span><span class="op">(</span><span class="va">TTAint</span>, <span class="va">side</span>, <span class="va">s</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">pro</span><span class="op">[</span>, <span class="va">value</span> <span class="op">:=</span> <span class="va">count</span><span class="op">/</span><span class="va">total</span><span class="op">]</span></span>
<span><span class="va">dsafe_be</span> <span class="op">&lt;-</span> <span class="va">pro</span><span class="op">[</span><span class="va">R</span> <span class="op">==</span> <span class="st">"safe"</span><span class="op">]</span></span>
<span></span>
<span><span class="co">## replace with data.frame(dsafe_af) to get safe proportion | after the car</span></span>
<span><span class="va">pro</span> <span class="op">&lt;-</span> <span class="va">d</span><span class="op">[</span><span class="va">G</span> <span class="op">==</span> <span class="st">"after"</span>, <span class="fu">.</span><span class="op">(</span>count <span class="op">=</span> <span class="va">.N</span><span class="op">)</span>, <span class="fu">.</span><span class="op">(</span><span class="va">TTAint</span>, <span class="va">TTANme</span>, <span class="va">side</span>, <span class="va">R</span>, <span class="va">s</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">pro</span><span class="op">[</span>, <span class="va">total</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span>, <span class="fu">.</span><span class="op">(</span><span class="va">TTAint</span>, <span class="va">side</span>, <span class="va">s</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">pro</span><span class="op">[</span>, <span class="va">value</span> <span class="op">:=</span> <span class="va">count</span><span class="op">/</span><span class="va">total</span><span class="op">]</span></span>
<span><span class="va">dsafe_af</span> <span class="op">&lt;-</span> <span class="va">pro</span><span class="op">[</span><span class="va">R</span> <span class="op">==</span> <span class="st">"safe"</span><span class="op">]</span></span></code></pre></div>
<p>The following lists multiple logistic regression models. One should
be able to replicate these modelling by replacing the <em>data</em> by
for instance changing <em>data.frame(dp_be)</em> to
<em>data.frame(dp_af)</em>.</p>
<p>I use a population-level Gaussian distribution of <span class="math inline">\(location = 0\)</span>, <span class="math inline">\(scale =10\)</span>, for the intercept parameter,
which is to model random-effect individual factor and another Gaussian,
same parameter values, for the slope parameter. Depending on the models,
there are one to three slope hyper-parameters.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m0</span> <span class="op">&lt;-</span> <span class="fu">map2stan</span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">alist</a></span> <span class="op">(</span></span>
<span>    <span class="va">count</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">dbinom</a></span><span class="op">(</span><span class="va">total</span>, <span class="va">p</span><span class="op">)</span>,</span>
<span>    <span class="fu">logit</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">a</span><span class="op">[</span><span class="va">s</span><span class="op">]</span>,</span>
<span>    <span class="va">a</span><span class="op">[</span><span class="va">s</span><span class="op">]</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">dp_be</span><span class="op">)</span>, chain <span class="op">=</span> <span class="fl">4</span>, iter <span class="op">=</span> <span class="fl">3000</span>, warmup <span class="op">=</span> <span class="fl">1500</span>, cores <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu">map2stan</span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">alist</a></span> <span class="op">(</span></span>
<span>    <span class="va">count</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">dbinom</a></span><span class="op">(</span><span class="va">total</span>, <span class="va">p</span><span class="op">)</span>,</span>
<span>    <span class="fu">logit</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">a</span><span class="op">[</span><span class="va">s</span><span class="op">]</span> <span class="op">+</span> <span class="va">b1</span> <span class="op">*</span> <span class="va">TTAint</span>,</span>
<span>    <span class="va">a</span><span class="op">[</span><span class="va">s</span><span class="op">]</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>    <span class="va">b1</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">dp_be</span><span class="op">)</span>, iter <span class="op">=</span> <span class="fl">3000</span>, warmup <span class="op">=</span> <span class="fl">1500</span>, chain <span class="op">=</span> <span class="fl">4</span>, cores <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu">map2stan</span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">alist</a></span> <span class="op">(</span></span>
<span>    <span class="va">count</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">dbinom</a></span><span class="op">(</span><span class="va">total</span>, <span class="va">p</span><span class="op">)</span>,</span>
<span>    <span class="fu">logit</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">a</span><span class="op">[</span><span class="va">s</span><span class="op">]</span> <span class="op">+</span> <span class="va">b2</span> <span class="op">*</span> <span class="va">side</span>,</span>
<span>    <span class="va">a</span><span class="op">[</span><span class="va">s</span><span class="op">]</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>    <span class="va">b2</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">dp_be</span><span class="op">)</span>, iter <span class="op">=</span> <span class="fl">3000</span>, warmup <span class="op">=</span> <span class="fl">1500</span>, chain <span class="op">=</span> <span class="fl">4</span>, cores <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">m3</span> <span class="op">&lt;-</span> <span class="fu">map2stan</span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">alist</a></span> <span class="op">(</span></span>
<span>    <span class="va">count</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">dbinom</a></span><span class="op">(</span><span class="va">total</span>, <span class="va">p</span><span class="op">)</span>,</span>
<span>    <span class="fu">logit</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">a</span><span class="op">[</span><span class="va">s</span><span class="op">]</span> <span class="op">+</span> <span class="va">b1</span> <span class="op">*</span> <span class="va">TTAint</span> <span class="op">+</span>  <span class="va">b2</span> <span class="op">*</span> <span class="va">side</span>,</span>
<span>    <span class="va">a</span><span class="op">[</span><span class="va">s</span><span class="op">]</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>    <span class="va">b1</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>    <span class="va">b2</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">dp_be</span><span class="op">)</span>, iter <span class="op">=</span> <span class="fl">3000</span>, warmup <span class="op">=</span> <span class="fl">1500</span>, chain <span class="op">=</span> <span class="fl">4</span>, cores <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">m4</span> <span class="op">&lt;-</span> <span class="fu">map2stan</span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">alist</a></span> <span class="op">(</span></span>
<span>    <span class="va">count</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">dbinom</a></span><span class="op">(</span><span class="va">total</span>, <span class="va">p</span><span class="op">)</span>,</span>
<span>    <span class="fu">logit</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">a</span><span class="op">[</span><span class="va">s</span><span class="op">]</span> <span class="op">+</span> <span class="va">b1</span> <span class="op">*</span> <span class="va">TTAint</span> <span class="op">+</span>  <span class="va">b2</span> <span class="op">*</span> <span class="va">side</span> <span class="op">+</span> <span class="va">b3</span> <span class="op">*</span> <span class="va">TTAint</span> <span class="op">*</span> <span class="va">side</span>,</span>
<span>    <span class="va">a</span><span class="op">[</span><span class="va">s</span><span class="op">]</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>    <span class="va">b1</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>    <span class="va">b2</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>    <span class="va">b3</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">dp_be</span><span class="op">)</span>, iter <span class="op">=</span> <span class="fl">3000</span>, warmup <span class="op">=</span> <span class="fl">1500</span>, chain <span class="op">=</span> <span class="fl">4</span>, cores <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># save(m0, m1, m2, m3, m4, file = "tests/2_preprocess/data/logistic_precar.RData")</span></span>
<span><span class="co"># save(m0, m1, m2, m3, m4, file = "tests/2_preprocess/data/logistic_safe_before.RData")</span></span>
<span><span class="co"># save(m0, m1, m2, m3, m4, file = "tests/2_preprocess/data/logistic_safe_after.RData")</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="response-times">Response Times<a class="anchor" aria-label="anchor" href="#response-times"></a>
</h3>
<p>The following code is almost identical to the above. I replace the
logistic regression with Gaussian (linear) regression models.</p>
<p>Similar to the logistic model, I also use a population-level Gaussian
distribution of <span class="math inline">\(location = 0\)</span>, <span class="math inline">\(scale =10\)</span>, for the intercept parameter,
which is to model random-effect individual factor and another Gaussian,
same parameter values, for the slope parameter. Depending on the models,
there are one to three slope hyper-parameters. I use a population-level
Cauchy distribution, <span class="math inline">\(location = 0\)</span>,
<span class="math inline">\(scale = 2\)</span>, to model the hyper-level
variability parameters.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rt</span> <span class="op">&lt;-</span> <span class="va">d</span><span class="op">[</span><span class="va">R</span> <span class="op">==</span> <span class="st">"safe"</span>, <span class="fu">.</span><span class="op">(</span>count <span class="op">=</span> <span class="va">.N</span>,</span>
<span>                       value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">RT</span><span class="op">)</span><span class="op">)</span>, <span class="fu">.</span><span class="op">(</span><span class="va">TTAint</span>, <span class="va">TTANme</span>, <span class="va">side</span>, <span class="va">G</span>, <span class="va">s</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">dbe</span> <span class="op">&lt;-</span> <span class="va">rt</span><span class="op">[</span><span class="va">G</span> <span class="op">==</span> <span class="st">"before"</span><span class="op">]</span> </span>
<span><span class="va">daf</span> <span class="op">&lt;-</span> <span class="va">rt</span><span class="op">[</span><span class="va">G</span> <span class="op">==</span> <span class="st">"after"</span><span class="op">]</span> </span>
<span></span>
<span><span class="va">rt</span> <span class="op">&lt;-</span> <span class="va">d</span><span class="op">[</span><span class="va">R</span> <span class="op">==</span> <span class="st">"hit"</span>, <span class="fu">.</span><span class="op">(</span>count <span class="op">=</span> <span class="va">.N</span>,</span>
<span>                      value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">RT</span><span class="op">)</span><span class="op">)</span>, <span class="fu">.</span><span class="op">(</span><span class="va">TTAint</span>, <span class="va">TTANme</span>, <span class="va">side</span>, <span class="va">G</span>, <span class="va">s</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">dbe_hit</span> <span class="op">&lt;-</span> <span class="va">rt</span><span class="op">[</span><span class="va">G</span> <span class="op">==</span> <span class="st">"before"</span><span class="op">]</span> </span>
<span><span class="va">daf_hit</span> <span class="op">&lt;-</span> <span class="va">rt</span><span class="op">[</span><span class="va">G</span> <span class="op">==</span> <span class="st">"after"</span><span class="op">]</span> </span>
<span></span>
<span><span class="va">m0</span> <span class="op">&lt;-</span> <span class="fu">map2stan</span><span class="op">(</span>                          </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">alist</a></span><span class="op">(</span></span>
<span>    <span class="va">value</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">mu</span>, <span class="va">sigma</span><span class="op">)</span>,</span>
<span>    <span class="va">mu</span> <span class="op">&lt;-</span> <span class="va">a</span><span class="op">[</span><span class="va">s</span><span class="op">]</span>,</span>
<span>    <span class="va">a</span><span class="op">[</span><span class="va">s</span><span class="op">]</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">amu</span>, <span class="va">sigma_a</span><span class="op">)</span>,           </span>
<span>    <span class="va">amu</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>,  </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">sigma</span>, <span class="va">sigma_a</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Cauchy.html" class="external-link">dcauchy</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">dbe</span><span class="op">)</span>, iter <span class="op">=</span> <span class="fl">5000</span>, warmup <span class="op">=</span> <span class="fl">2500</span>, chains <span class="op">=</span> <span class="fl">4</span>, cores <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu">map2stan</span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">alist</a></span><span class="op">(</span></span>
<span>    <span class="va">value</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">mu</span>, <span class="va">sigma</span><span class="op">)</span>,</span>
<span>    <span class="va">mu</span> <span class="op">&lt;-</span> <span class="va">a</span><span class="op">[</span><span class="va">s</span><span class="op">]</span> <span class="op">+</span> <span class="va">b1</span> <span class="op">*</span> <span class="va">TTAint</span>,</span>
<span>    <span class="va">a</span><span class="op">[</span><span class="va">s</span><span class="op">]</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">amu</span>, <span class="va">sigma_a</span><span class="op">)</span>,            </span>
<span>    <span class="va">amu</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>    <span class="va">b1</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">sigma</span>, <span class="va">sigma_a</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Cauchy.html" class="external-link">dcauchy</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">dbe</span><span class="op">)</span>, iter <span class="op">=</span> <span class="fl">5000</span>, warmup <span class="op">=</span> <span class="fl">2500</span>, chains <span class="op">=</span> <span class="fl">4</span>, cores <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu">map2stan</span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">alist</a></span><span class="op">(</span></span>
<span>    <span class="va">value</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">mu</span>, <span class="va">sigma</span><span class="op">)</span>,</span>
<span>    <span class="va">mu</span> <span class="op">&lt;-</span> <span class="va">a</span><span class="op">[</span><span class="va">s</span><span class="op">]</span> <span class="op">+</span> <span class="va">b2</span> <span class="op">*</span> <span class="va">side</span>,</span>
<span>    <span class="va">a</span><span class="op">[</span><span class="va">s</span><span class="op">]</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">amu</span>, <span class="va">sigma_a</span><span class="op">)</span>,            </span>
<span>    <span class="va">amu</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>    <span class="va">b2</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">sigma</span>, <span class="va">sigma_a</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Cauchy.html" class="external-link">dcauchy</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">dbe</span><span class="op">)</span>, iter <span class="op">=</span> <span class="fl">5000</span>, warmup <span class="op">=</span> <span class="fl">2500</span>, chains <span class="op">=</span> <span class="fl">4</span>, cores <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">m3</span> <span class="op">&lt;-</span> <span class="fu">map2stan</span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">alist</a></span> <span class="op">(</span></span>
<span>    <span class="va">value</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">mu</span>, <span class="va">sigma</span><span class="op">)</span>,</span>
<span>    <span class="va">mu</span> <span class="op">&lt;-</span> <span class="va">a</span><span class="op">[</span><span class="va">s</span><span class="op">]</span> <span class="op">+</span> <span class="va">b1</span> <span class="op">*</span> <span class="va">TTAint</span> <span class="op">+</span>  <span class="va">b2</span> <span class="op">*</span> <span class="va">side</span>,</span>
<span>    <span class="va">a</span><span class="op">[</span><span class="va">s</span><span class="op">]</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">amu</span>, <span class="va">sigma_a</span><span class="op">)</span>,            </span>
<span>    <span class="va">amu</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>    <span class="va">b1</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>    <span class="va">b2</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">sigma</span>, <span class="va">sigma_a</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Cauchy.html" class="external-link">dcauchy</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">dbe</span><span class="op">)</span>, iter <span class="op">=</span> <span class="fl">5000</span>, warmup <span class="op">=</span> <span class="fl">2500</span>, chains <span class="op">=</span> <span class="fl">4</span>, cores <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">m4</span> <span class="op">&lt;-</span> <span class="fu">map2stan</span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">alist</a></span> <span class="op">(</span></span>
<span>    <span class="va">value</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">mu</span>, <span class="va">sigma</span><span class="op">)</span>,</span>
<span>    <span class="va">mu</span> <span class="op">&lt;-</span> <span class="va">a</span><span class="op">[</span><span class="va">s</span><span class="op">]</span> <span class="op">+</span> <span class="va">b1</span> <span class="op">*</span> <span class="va">TTAint</span> <span class="op">+</span>  <span class="va">b2</span> <span class="op">*</span> <span class="va">side</span> <span class="op">+</span> <span class="va">b3</span> <span class="op">*</span> <span class="va">TTAint</span> <span class="op">*</span> <span class="va">side</span>,</span>
<span>    <span class="va">a</span><span class="op">[</span><span class="va">s</span><span class="op">]</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">amu</span>, <span class="va">sigma_a</span><span class="op">)</span>,</span>
<span>    <span class="va">amu</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>    <span class="va">b1</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>    <span class="va">b2</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>    <span class="va">b3</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">sigma</span>, <span class="va">sigma_a</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Cauchy.html" class="external-link">dcauchy</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">dbe</span><span class="op">)</span>, iter <span class="op">=</span> <span class="fl">5000</span>, warmup <span class="op">=</span> <span class="fl">2500</span>, chains <span class="op">=</span> <span class="fl">4</span>, cores <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># save(m0, m1, m2, m3, m4, file = "tests/2_preprocess/data/logistic_rt_before.RData")</span></span>
<span><span class="co"># save(m0, m1, m2, m3, m4, file = "tests/2_preprocess/data/logistic_rt_after.RData")</span></span>
<span><span class="co"># save(m0, m1, m2, m3, m4, file = "tests/2_preprocess/data/logistic_rt_before_hit.RData")</span></span></code></pre></div>
<p>Model 0 (m0), a baseline model, assumes the only factor resulting
different response proportions is individual differences, which is
governed by a population distribution of <span class="math inline">\(N(0, 10)\)</span>. The draws from this population
distribution is linked to the proportion parameter in the binomial
distribution by a <em>logit</em> function.</p>
<p>Model 1 to Model 4 gradually add more influences from the TTA and R-L
factors, as well as their interaction. Note <em>stan</em> fits will
result in slightly difference numbers, if random seeds are not the
same.</p>
<p>Mostly, model 1, 3 and 4 were selected by using WAIC, as similarly
good models. This is indicative of that Model 0 is a less plausible
model. That I am confident that it is unlikely that the only influence
on dependent variables is from individual differences.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"tests/2_preprocess/data/logistic_precar.RData"</span><span class="op">)</span></span>
<span><span class="va">ms0</span> <span class="op">&lt;-</span> <span class="fu">compare</span><span class="op">(</span><span class="va">m0</span>, <span class="va">m1</span>, <span class="va">m2</span>, <span class="va">m3</span>, <span class="va">m4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"tests/2_preprocess/data/logistic_safe_before.RData"</span><span class="op">)</span></span>
<span><span class="va">ms1</span> <span class="op">&lt;-</span> <span class="fu">compare</span><span class="op">(</span><span class="va">m0</span>, <span class="va">m1</span>, <span class="va">m2</span>, <span class="va">m3</span>, <span class="va">m4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"tests/2_preprocess/data/logistic_safe_after.RData"</span><span class="op">)</span></span>
<span><span class="va">ms2</span> <span class="op">&lt;-</span> <span class="fu">compare</span><span class="op">(</span><span class="va">m0</span>, <span class="va">m1</span>, <span class="va">m2</span>, <span class="va">m3</span>, <span class="va">m4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"tests/2_preprocess/data/logistic_rt_before.RData"</span><span class="op">)</span></span>
<span><span class="va">ms3</span> <span class="op">&lt;-</span> <span class="fu">compare</span><span class="op">(</span><span class="va">m0</span>, <span class="va">m1</span>, <span class="va">m2</span>, <span class="va">m3</span>, <span class="va">m4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"tests/2_preprocess/data/logistic_rt_after.RData"</span><span class="op">)</span></span>
<span><span class="va">ms4</span> <span class="op">&lt;-</span> <span class="fu">compare</span><span class="op">(</span><span class="va">m0</span>, <span class="va">m1</span>, <span class="va">m2</span>, <span class="va">m3</span>, <span class="va">m4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"tests/2_preprocess/data/logistic_rt_before_hit.RData"</span><span class="op">)</span></span>
<span><span class="va">ms5</span> <span class="op">&lt;-</span> <span class="fu">compare</span><span class="op">(</span><span class="va">m0</span>, <span class="va">m1</span>, <span class="va">m2</span>, <span class="va">m3</span>, <span class="va">m4</span><span class="op">)</span></span>
<span><span class="co"># plot(ms5)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ms0</span>, <span class="va">ms1</span>, <span class="va">ms2</span>, <span class="va">ms3</span>, <span class="va">ms4</span>, <span class="va">m5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Pre-car proportion | safe</span></span>
<span><span class="co">#    WAIC pWAIC dWAIC weight    SE   dSE</span></span>
<span><span class="co"># m3 7148  38.6   0.0   0.65 79.58    NA</span></span>
<span><span class="co"># m4 7150  39.8   1.4   0.33 79.76  2.21</span></span>
<span><span class="co"># m1 7155  37.8   6.4   0.03 79.49  5.65</span></span>
<span><span class="co"># m2 7926  37.9 777.6   0.00 65.78 54.66</span></span>
<span><span class="co"># m0 7932  37.0 783.8   0.00 65.70 54.98</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># Safe proportion | made before </span></span>
<span><span class="co">#    WAIC pWAIC dWAIC weight    SE   dSE</span></span>
<span><span class="co"># m3 1153  39.2   0.0   0.69 68.60    NA</span></span>
<span><span class="co"># m4 1155  40.6   2.1   0.24 69.20  1.79</span></span>
<span><span class="co"># m1 1158  38.1   4.7   0.07 68.80  5.33</span></span>
<span><span class="co"># m2 1894  38.6 740.8   0.00 83.72 57.64</span></span>
<span><span class="co"># m0 1906  37.3 753.0   0.00 83.81 58.07</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># Safe proportion | made after </span></span>
<span><span class="co">#    WAIC pWAIC dWAIC weight    SE  dSE</span></span>
<span><span class="co"># m0 88.7   7.4   0.0   0.45 28.42   NA</span></span>
<span><span class="co"># m2 88.9   8.0   0.2   0.40 28.48 0.39</span></span>
<span><span class="co"># m1 92.3   8.8   3.6   0.07 29.90 2.03</span></span>
<span><span class="co"># m3 92.4   9.4   3.8   0.07 30.02 2.57</span></span>
<span><span class="co"># m4 97.6  11.6   8.9   0.01 32.85 7.12</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># RT | made before </span></span>
<span><span class="co">#      WAIC pWAIC dWAIC weight    SE   dSE</span></span>
<span><span class="co"># m1 -478.4  37.8   0.0   0.69 52.63    NA</span></span>
<span><span class="co"># m3 -475.9  38.5   2.5   0.20 52.39  1.41</span></span>
<span><span class="co"># m4 -474.7  40.6   3.8   0.11 54.61  5.30</span></span>
<span><span class="co"># m0 -417.8  36.0  60.6   0.00 51.95 17.61</span></span>
<span><span class="co"># m2 -415.8  36.9  62.6   0.00 51.55 17.48</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># RT | made after</span></span>
<span><span class="co">#      WAIC pWAIC  dWAIC weight    SE   dSE</span></span>
<span><span class="co"># m1 -735.0  34.5    0.0   0.49 27.73    NA</span></span>
<span><span class="co"># m3 -734.3  35.3    0.7   0.34 27.76  2.36</span></span>
<span><span class="co"># m4 -733.0  36.4    2.1   0.17 27.94  3.71</span></span>
<span><span class="co"># m0  567.4   3.2 1302.5   0.00 14.51 30.68</span></span>
<span><span class="co"># m2  569.1   4.0 1304.2   0.00 14.64 30.77</span></span>
<span></span>
<span><span class="co"># RT | made before, collision</span></span>
<span><span class="co"># WAIC pWAIC dWAIC weight    SE   dSE</span></span>
<span><span class="co"># m1 120.3  22.6   0.0   0.60 53.74    NA</span></span>
<span><span class="co"># m3 121.5  23.9   1.1   0.34 53.26  1.68</span></span>
<span><span class="co"># m4 125.2  25.9   4.8   0.05 53.54  3.16</span></span>
<span><span class="co"># m0 254.8  14.6 134.4   0.00 41.96 26.99</span></span>
<span><span class="co"># m2 256.1  15.0 135.8   0.00 41.91 26.69</span></span>
<span></span>
<span><span class="co"># Examine stanfit object in each model object to see Rhat all around 1's.</span></span>
<span><span class="va">m0</span><span class="op">@</span><span class="va">stanfit</span></span></code></pre></div>
<p>The following code creates a data frame to plot model comparison
together.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dms0</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="op">(</span><span class="va">ms0</span><span class="op">@</span><span class="va">output</span><span class="op">)</span></span>
<span><span class="va">dms1</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="op">(</span><span class="va">ms1</span><span class="op">@</span><span class="va">output</span><span class="op">)</span></span>
<span><span class="va">dms2</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="op">(</span><span class="va">ms2</span><span class="op">@</span><span class="va">output</span><span class="op">)</span></span>
<span><span class="va">dms3</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="op">(</span><span class="va">ms3</span><span class="op">@</span><span class="va">output</span><span class="op">)</span></span>
<span><span class="va">dms4</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="op">(</span><span class="va">ms4</span><span class="op">@</span><span class="va">output</span><span class="op">)</span></span>
<span><span class="va">dms5</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="op">(</span><span class="va">ms5</span><span class="op">@</span><span class="va">output</span><span class="op">)</span></span>
<span><span class="va">dms0</span><span class="op">$</span><span class="va">M</span> <span class="op">&lt;-</span> <span class="st">"Pre-car proportion | safe"</span></span>
<span><span class="va">dms1</span><span class="op">$</span><span class="va">M</span> <span class="op">&lt;-</span> <span class="st">"Safe proportion | made before"</span></span>
<span><span class="va">dms2</span><span class="op">$</span><span class="va">M</span> <span class="op">&lt;-</span> <span class="st">"Safe proportion | made after"</span></span>
<span><span class="va">dms3</span><span class="op">$</span><span class="va">M</span> <span class="op">&lt;-</span> <span class="st">"RT | made before"</span></span>
<span><span class="va">dms4</span><span class="op">$</span><span class="va">M</span> <span class="op">&lt;-</span> <span class="st">"RT | made after"</span></span>
<span><span class="va">dms5</span><span class="op">$</span><span class="va">M</span> <span class="op">&lt;-</span> <span class="st">"RT | made before, collision"</span></span>
<span></span>
<span><span class="va">dms0</span><span class="op">$</span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">ms0</span><span class="op">@</span><span class="va">output</span><span class="op">)</span>, </span>
<span>                 levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">ms0</span><span class="op">@</span><span class="va">output</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">dms0</span><span class="op">$</span><span class="va">WAIC</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">dms1</span><span class="op">$</span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">ms1</span><span class="op">@</span><span class="va">output</span><span class="op">)</span>, </span>
<span>                 levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">ms1</span><span class="op">@</span><span class="va">output</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">dms1</span><span class="op">$</span><span class="va">WAIC</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">dms2</span><span class="op">$</span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">ms2</span><span class="op">@</span><span class="va">output</span><span class="op">)</span>, </span>
<span>                 levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">ms2</span><span class="op">@</span><span class="va">output</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">dms2</span><span class="op">$</span><span class="va">WAIC</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">dms3</span><span class="op">$</span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">ms3</span><span class="op">@</span><span class="va">output</span><span class="op">)</span>, </span>
<span>                 levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">ms3</span><span class="op">@</span><span class="va">output</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">dms3</span><span class="op">$</span><span class="va">WAIC</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">dms4</span><span class="op">$</span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">ms4</span><span class="op">@</span><span class="va">output</span><span class="op">)</span>, </span>
<span>                 levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">ms4</span><span class="op">@</span><span class="va">output</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">dms4</span><span class="op">$</span><span class="va">WAIC</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">dms5</span><span class="op">$</span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">ms5</span><span class="op">@</span><span class="va">output</span><span class="op">)</span>, </span>
<span>                 levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">ms5</span><span class="op">@</span><span class="va">output</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">dms5</span><span class="op">$</span><span class="va">WAIC</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">dms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">dms0</span>, <span class="va">dms1</span>, <span class="va">dms2</span>, <span class="va">dms3</span>, <span class="va">dms4</span>, <span class="va">dms5</span><span class="op">)</span></span>
<span><span class="va">Models</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Pre-car proportion | safe"</span>, <span class="st">"Safe proportion | made before"</span>,</span>
<span>            <span class="st">"Safe proportion | made after"</span>, <span class="st">"RT | made before"</span>, <span class="st">"RT | made after"</span>,</span>
<span>            <span class="st">"RT | made before, collision"</span><span class="op">)</span></span>
<span><span class="va">dms</span><span class="op">$</span><span class="va">M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">dms</span><span class="op">$</span><span class="va">M</span>, levels <span class="op">=</span> <span class="va">Models</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">dms</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">m</span>, y <span class="op">=</span> <span class="va">WAIC</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">m</span>, y <span class="op">=</span> <span class="va">WAIC</span>, ymin <span class="op">=</span> <span class="va">WAIC</span> <span class="op">+</span> <span class="va">SE</span>, ymax <span class="op">=</span> <span class="va">WAIC</span> <span class="op">-</span> <span class="va">SE</span><span class="op">)</span>,</span>
<span>                width <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="va">M</span><span class="op">~</span><span class="va">.</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Model"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">"Deviance"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">18</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/png.html" class="external-link">png</a></span><span class="op">(</span><span class="st">"tests/inst/figs/10_models_v1.png"</span>, <span class="fl">800</span>, <span class="fl">600</span><span class="op">)</span></span>
<span><span class="va">p</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>A graphic comparison does show qualitatively Model 1, 3, and 4 are
indistinguishable and Model 0 and 2 are also indistinguishable. The
significant result is that the two groups are not the same and the first
group is preferred. We select Model 1 in the first group on the ground
that it is the minimal, parsimonious model.</p>
<p><img src="../../reference/figures/10_models_v1.png" style="width:75.0%" alt="Model selection."> In addition to relying on
the abstract information criterion, WAIC, I further examine the fits of
model preditions. The big circles show the average values (across
participants). The numbers on top of these circles show the number of
responses, so it is clear that how many data points in each condition
the models are able to optimise against.</p>
<p>The small circles show responses from each participant. Model 0 and
Model 1 predictions are represented in red and grey, respectively.</p>
<p>Three important findings can be concluded. First, the data are not
consistent with the argument that participants always decided to wait
and made post-car responses, if one looks at the data in the 2.5-s TTA,
which has 99.7% of safe responses, all made after the car passed,</p>
<p>To believe in this argument, one must overlook the data in the 3-s
TTA condition. Participants made a good number of responses before the
car passes and there was no way for them to know whether the car will
arrive at 2.5-s or 3-s in a trial, let alone that TTA was made slightly
and randomly deviated from the set time. Further, trials from each TTA
conditions appeared randomly. Participants must carefully evaluate the
imperative stimulus; otherwise, the data should show for all four TTA
conditions, that most, if not all, responses are made after the car
passes.</p>
<div class="figure">
<img src="../../reference/figures/10_glm_v1.png" style="width:75.0%" alt=""><p class="caption">Response proportion made before the car passes</p>
</div>
<p>Second, the L-R factor does not have influence on behavioural
responses. This conclusion is supported by the analysis that Model1, 3,
and 4 show equally good fit to the data and Model 2 is similar to the
baseline model (ie Model 0).</p>
<p>Third, the TTA factor has a strong influence on participants’
response proportions of choosing to respond before or after the car
passes as well as their ability to make safe crosses before the car
passes, although it makes no difference for the proportion of safe
crosses after the car passes.</p>
<p>Four, the TTA factor also has a strong influence on participants’
response latency. It is clear for the responses made after the car
passes, but ambiguous for the responses made before the car passes,
which possibly has no impact. Because the Bayesian model conventionally
provides probabilistic information and our data and code are transparent
for anyone to use, I wish to leave the read to decide for themselves on
this matter.</p>
<p>The TTA factor seems to have an impact on the latency of the
responses resulting in collisions. This impact, however, is not as
strong as the other dependent variables, because the WAIC difference is
not as big as the others. The model fit to the data does suggest that we
can believe that the TTA does affect the collision RT. As this
observation is practically important that may inform policy to pay
attention to TTA on collision prevention. We recommend it to be
considered significant. Again, the reader could decide for themselves to
examine the analyses we report here or re-analyse our data.</p>
<p>This concludes this vignette. In the next step, I will employ four
sequence-sampling models in an attempt to explain all dependent
variables in one framework and compare their difference to make
inferences on plausible psychological process.</p>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="reference">Reference<a class="anchor" aria-label="anchor" href="#reference"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-chuWhyPeopleCross2004" class="csl-entry">
Chu, X., Guttenplan, M., and Baltes, M. R. (2004). Why <span>People
Cross Where They Do</span>: <span>The Role</span> of <span>Street
Environment</span>. <em>Transportation Research Record</em> 1878, 3–10.
doi: <a href="https://doi.org/10.3141/1878-01" class="external-link">10.3141/1878-01</a>.
</div>
<div id="ref-linParallelProbabilityDensity2019" class="csl-entry">
Lin, Y.-S., Heathcote, A., and Holmes, W. R. (2019). Parallel
probability density approximation. <em>Behavior Research Methods</em>
51, 2777–2799. doi: <a href="https://doi.org/10.3758/s13428-018-1153-1" class="external-link">10.3758/s13428-018-1153-1</a>.
</div>
<div id="ref-turnerGeneralizedLikelihoodfreeMethod2014" class="csl-entry">
Turner, B. M., and Sederberg, P. B. (2014). A generalized,
likelihood-free method for posterior estimation. <em>Psychon Bull
Rev</em> 21, 227–250. doi: <a href="https://doi.org/10.3758/s13423-013-0530-0" class="external-link">10.3758/s13423-013-0530-0</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Yi-Shin Lin.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
