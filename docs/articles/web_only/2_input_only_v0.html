<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="pedxing">
<title>2. Constant Drift-rates • pedxing</title>
<script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../../pkgdown.js"></script><meta property="og:title" content="2. Constant Drift-rates">
<meta property="og:description" content="pedxing">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../../index.html">pedxing</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../../articles/web_only/0_preprocessing.html">0. Experimental Protocol and Preprocessing</a>
    <a class="dropdown-item" href="../../articles/web_only/1_glm.html">1. Multi-level Regression Models</a>
    <a class="dropdown-item" href="../../articles/web_only/2_input_only_v0.html">2. Constant Drift-rates</a>
    <a class="dropdown-item" href="../../articles/web_only/3_leak_v0.html">2. Comparing the Input-only model to the Leakage and Inhibition Models</a>
    <a class="dropdown-item" href="../../articles/web_only/4_LCA_v0.html">2. Leaky Competing Accumulation Model</a>
    <a class="dropdown-item" href="../../articles/web_only/archive/2_LCA.html">2. Leaky Competing Accumulator Model</a>
    <a class="dropdown-item" href="../../articles/web_only/archive/2_LCA_v1.html">2. Leaky Competing Accumulation Model</a>
    <a class="dropdown-item" href="../../articles/web_only/archive/Journal_plan.html">Reviewer #1</a>
    <a class="dropdown-item" href="../../articles/web_only/hmc-two.html">Use Hamiltonian Dynamics in ggdmc -- Two</a>
    <a class="dropdown-item" href="../../articles/web_only/hmc.html">Use Hamiltonian Dynamics in ggdmc -- One</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>2. Constant Drift-rates</h1>
                        <h4 data-toc-skip class="author">Yi-Shin
Lin<sup>1</sup>, Corresponding Author<sup>1,*</sup>
</h4>
            
            <h4 data-toc-skip class="date">2022-10-03</h4>
      
      
      <div class="d-none name"><code>2_input_only_v0.Rmd</code></div>
    </div>

    
    
<style type="text/css">
#TOC {
  left: 200px;
  margin: 20px 0px 25px 0px;
}

.main-container {
    margin-left: 200px;
}
</style>
<p>Here I evaluate a method to recover the parameters in the leaky
competing accumulation (LCA) model <span class="citation">(Usher and
McClelland 2001)</span>. The first aim is to find a state to an extent
that the LCA model implemented here can be useful in studying
psychological mechanisms, especially the assumption of neural lateral
inhibition and the signal leakage. The LCA model initially associated
its many parameters with and based its mechanical assumptions on
neuronal computations but later, by an extension of its neural-network
assumption, extended this neuronal-based account to cognitive
computation, such as relational evaluation and loss aversion. It thus
leaves a gap on how the assumption of unit accumulator driven by one
neuron or more probably a cell population with limited number of neurons
transcend to a high-level psychological mechanisms.</p>
<p>Here my aim is to fill in the gap by providing one piece of
physiological (ie ERP-based) evidence showing and comparing the
ERP-constraint, LCA, UM and piece-wise models.</p>
<p>One nuance that worth noting regarding the LCA model is that, on page
559, when applying to 2AFC, the authors <span class="citation">(Usher
and McClelland 2001)</span> posited a further assumption to constraint
<span class="math inline">\(\rho_1 + \rho_2 = 1\)</span>. A similar
constraint was used in <span class="citation">(Miletić et al.
2017)</span>.</p>
<p>In the free-response task where no deadline is imposed, the decision
on the assumption about the decision threshold can affect the RT and
response proportion prediction. In designing a model, researchers make a
decision on using either a fixed criterion and what value or using a
time-evolving (dynamic) criteria. On the other hand, in the time-limited
task, “the analysis is simplified when the amount of time allowed for
processing is controlled (e.g., by means of a signal that indicates when
to respond)”<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;In choosing a criterion, our aim of modelling is
neither. In the road-crossing task, I assume pedestrians are
continuously assess the speed and doing arithmetic regarding the TTA of
the oncoming car.&lt;/p&gt;"><sup>1</sup></a>.</p>
<p>The LCA model is a linear model, when it is constructed without the
assumption of no negative activity, i.e., excluding the sub-equation
<span class="math inline">\(x_i = max(x_i, 0)\)</span>. Without the
non-linear component, its stochastic component is the same as many other
variants in the category of sequential sampling model, namely zero-mean
and <span class="math inline">\(\sigma^2\)</span> variance Gaussian.</p>
<p>One model investigation suggested that the LCA model might have
multiple unique sets of optimised parameters, given even a large number
of simulated, presumably ideal, data points in <span class="citation">(Miletić et al. 2017)</span>, although there exist a
good number of papers authored by the colleagues of the original model
developers <span class="citation">(Teodorescu and Usher 2013; Tsetsos,
Usher, and Chater 2010; Tsetsos et al. 2012)</span>, who used
successfully the LCA model to study several psychological
mechanisms.</p>
<p>The result from previous studies of fitting models with multiple
correlated, sometimes, redundantly structural, parameters do indicate
that if one uses pure mathematical metrics and methods, such maximising
model likelihoods via maximum likelihood estimation or Bayesian MCMC
inference, to optimise the model around a data set, the LCA <span class="citation">(Miletić et al. 2017; Holmes and Trueblood 2018; Holmes
2015)</span>, will have extremely difficulty to faithfully recover the
parameters. One possibility is that multiple sets of parameters could
generate equal good fits of choice RT data.</p>
<p>Our aim in this work is to investigate to what extent that we could
recover parameters in the models designing to study signal suppression
if we incorporate physiological data and use also the (average) path of
evidence accumulation to help parameter optimisation.</p>
<p>I will assemble a version of piecewise LCA model based on a similar
logic as the pDDM <span class="citation">(Holmes and Trueblood
2018)</span> and pLBA model.</p>
<div class="figure">
<img src="images/LCA.png" style="width:50.0%" alt=""><p class="caption">An illustration of two layers in a neural-network
model.</p>
</div>
<p>This vignette focuses on the LCA, 2 and 3 accumulators.</p>
<div class="section level2">
<h2 id="drift-rate-model">Drift-rate Model<a class="anchor" aria-label="anchor" href="#drift-rate-model"></a>
</h2>
<div class="section level3">
<h3 id="a-detour-to-the-lba-model">A Detour to the LBA model<a class="anchor" aria-label="anchor" href="#a-detour-to-the-lba-model"></a>
</h3>
<p>When assuming the inputs from a previous neural layer are the only
influence on the drift rate, <span class="math inline">\(dx_i\)</span>,
we can write, <span class="math inline">\(dx_i = \rho_i
\frac{dt}{\tau}\)</span>. This results in a similar case as that assumed
in the LBA model <span class="citation">(Brown and Heathcote
2008)</span>.</p>
<p>The LBA model assumes no within-trial variability (over time) and
uses the between-trial variability to match performance data across many
trials contributed by a participant. That is, it samples trial-by-trial
drift rates, <span class="math inline">\(\rho_i\)</span> from a Gaussian
distribution, <span class="math inline">\(N(\mu_j, \sigma)\)</span> and
trial-by-trial starting activations from a uniform distribution, <span class="math inline">\(U(0, A)\)</span>. (Here <span class="math inline">\(j\)</span> is to index an accumulator and <span class="math inline">\(i\)</span>, a trial).</p>
<p><span class="math display">\[
\rho_i \sim N(\mu_j, \sigma) \\
x_{0_i} \sim U(0, A)
\]</span></p>
</div>
<div class="section level3">
<h3 id="drift-rate-model-1">Drift-rate Model<a class="anchor" aria-label="anchor" href="#drift-rate-model-1"></a>
</h3>
<p>Back to the LCA equation. Without the stochastic component, we can
calculate exactly how many steps, given a distance (i.e., threshold,
denoted <span class="math inline">\(Z\)</span>), an accumulator will
take. <span class="math inline">\(Z\)</span> is fixed at 2.8 in the
following example.</p>
<p>I use the awkward name, <code>dtovertau</code>, to remind myself a
non-trivial nuance. The time step is often denoted as <span class="math inline">\(dt\)</span>, must be scaled to a natural time
unit, if one wish to investigate the association between the natural
times (often taken by a PC, software, and relevant hardware which also
involve some different measurement imprecision) and bypass likelihood
calculations with some tricks (e.g., using proportionality all the
way).</p>
<p>The scaling parameter is denoted <span class="math inline">\(\tau\)</span>. In the simulation, it is often more
convenient to use discrete unit step, for instance,
<code>for(size_t i = 0; i &lt; nstep; i++)</code>.</p>
<p>In this example, it took the first accumulator, who receives a large
input, 57 steps to pass a threshold of 2.8. 56th step reached 2.7999
activation, slightly lower than the 2.8. Without the noise term, it is
deterministic that the accumulator one is chosen.</p>
<p><span class="math display">\[dx_i = \rho_i  \frac{dt}{\tau} +  \xi_i
\sqrt{ \frac{dt}{\tau} } \]</span></p>
<p>The following lists the basic structure of the R code implementing
the equation. I coded it in a style, making it easier to be converted to
C++ and readable.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dtovertau</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span><span class="va">dt</span> <span class="op">&lt;-</span> <span class="fl">10</span>  <span class="co"># 10 ms</span></span>
<span><span class="va">tau</span> <span class="op">&lt;-</span> <span class="va">dt</span><span class="op">/</span><span class="va">dtovertau</span>; <span class="va">tau</span> <span class="co"># 100 </span></span>
<span><span class="va">sdv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">dtovertau</span><span class="op">)</span>; <span class="va">sdv</span></span>
<span></span>
<span><span class="co">## Parameters </span></span>
<span><span class="va">x0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>         <span class="co"># A; starting evidence values </span></span>
<span><span class="va">Z</span>  <span class="op">&lt;-</span> <span class="fl">2.8</span>             <span class="co"># b; common threshold across the xi</span></span>
<span><span class="va">t0</span> <span class="op">&lt;-</span> <span class="fl">.2</span>              <span class="co"># NDT</span></span>
<span><span class="va">I</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.385</span><span class="op">)</span>   <span class="co"># inputs from a previous layer = drift rate </span></span>
<span><span class="va">maxiter</span>   <span class="op">&lt;-</span> <span class="fl">5001</span></span>
<span></span>
<span><span class="co">## Prepare the process </span></span>
<span><span class="va">nacc</span>      <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">I</span><span class="op">)</span></span>
<span><span class="va">output</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">undone</span>    <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span><span class="va">counter</span>   <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">random</span>    <span class="op">&lt;-</span> <span class="cn">F</span></span>
<span><span class="va">nonlinear</span> <span class="op">&lt;-</span> <span class="cn">F</span>  <span class="co">## T or F does not matter for this set of parameters</span></span>
<span></span>
<span><span class="co">## initialise accumulator array to record activation value</span></span>
<span><span class="va">dx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">nacc</span><span class="op">)</span>;   </span>
<span><span class="va">activation</span> <span class="op">&lt;-</span> <span class="va">x0</span></span>
<span></span>
<span><span class="va">at_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="va">maxiter</span>, ncol <span class="op">=</span> <span class="va">nacc</span><span class="op">)</span></span>
<span><span class="va">dx_mat</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="va">maxiter</span>, ncol <span class="op">=</span> <span class="va">nacc</span><span class="op">)</span></span>
<span></span>
<span><span class="va">at_mat</span><span class="op">[</span><span class="va">counter</span><span class="op">+</span><span class="fl">1</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="va">activation</span></span>
<span><span class="va">dx_mat</span><span class="op">[</span><span class="va">counter</span><span class="op">+</span><span class="fl">1</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="kw">repeat</span> <span class="op">{</span></span>
<span>  <span class="va">counter</span> <span class="op">&lt;-</span> <span class="va">counter</span> <span class="op">+</span> <span class="fl">1</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">nacc</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="va">dx</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">dtovertau</span> <span class="op">*</span> <span class="va">I</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>    <span class="va">activation</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">activation</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="va">dx</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>    </span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">random</span><span class="op">)</span> <span class="va">activation</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">activation</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="va">sdv</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">activation</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&gt;=</span> <span class="va">Z</span><span class="op">)</span> <span class="op">{</span> </span>
<span>      <span class="va">output</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">counter</span> <span class="op">*</span> <span class="va">dt</span> <span class="op">-</span> <span class="fl">0.5</span><span class="op">*</span><span class="va">dt</span> <span class="op">+</span> <span class="va">t0</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>;</span>
<span>      <span class="va">output</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">i</span>; </span>
<span>      <span class="va">undone</span>    <span class="op">&lt;-</span> <span class="cn">FALSE</span>; </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Activation value: "</span>, <span class="va">activation</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">nonlinear</span> <span class="op">&amp;&amp;</span> <span class="va">activation</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span> <span class="va">activation</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span>;</span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">ac_mat</span><span class="op">[</span><span class="va">counter</span><span class="op">+</span><span class="fl">1</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">activation</span></span>
<span>  <span class="va">dx_mat</span><span class="op">[</span><span class="va">counter</span><span class="op">+</span><span class="fl">1</span>,<span class="op">]</span>  <span class="op">&lt;-</span> <span class="va">dx</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">counter</span> <span class="op">&gt;</span> <span class="va">maxiter</span> <span class="op">||</span> <span class="op">!</span><span class="va">undone</span><span class="op">)</span> <span class="kw">break</span>;</span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># counter's first index store step 0</span></span>
<span><span class="fl">2.8</span><span class="op">/</span> <span class="op">(</span><span class="va">dtovertau</span><span class="op">*</span><span class="va">I</span><span class="op">)</span></span>
<span><span class="va">counter</span></span>
<span><span class="co">## 57</span></span></code></pre></div>
<p>The figures in the upper row show C++ implementation results in the
same accumulation process as the R implementation. The figures in the
lower row added noise and thus, the accumulator two sometimes is
chosen.</p>
<p>The lesson here is that without the stochastic component, the
difference in drift rates decides which accumulator is chosen.</p>
<div class="figure">
<img src="images/LBA-1.png" style="width:50.0%" alt=""><p class="caption">Activation trajectories</p>
</div>
</div>
<div class="section level3">
<h3 id="free-response-paradigm">Free Response Paradigm<a class="anchor" aria-label="anchor" href="#free-response-paradigm"></a>
</h3>
<p>Free response paradigm refers to the design that the task permits
decision makers to make a choice without worrying a time limit. That is,
free to respond at any time (my interpretation). This term was used in
<span class="citation">(Bogacz et al. 2006)</span>, so I follow the
terminology used there, hoping that this is a standard or ubiquitous
term that researchers can understand. In implementing it in the model,
this design corresponds to the idea of <em>absorbing boundary</em> <span class="citation">(Feller 2008)</span>, another specialised term, meaning
that an accumulator terminates its activity when it reaches a threshold
and thus, metaphorically been absorbed by the boundary.</p>
<div class="section level4">
<h4 id="choice-probability">Choice Probability<a class="anchor" aria-label="anchor" href="#choice-probability"></a>
</h4>
<p>With noise, it is not always the first accumulator is chosen. I
examined the drift-rate difference between two accumulators. Fixing the
drift rate of the accumulator 1 at 0.5, the differences are 0.10 0.13
0.17 0.20 0.23 0.27 0.30 0.33 0.37 0.40. I assume that the accumulator 1
matches a target.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># rm(list = ls())</span></span>
<span><span class="co"># p.vector &lt;- c(Z = 2.8, t0 = .2, dtovertau = 0.1, dt = 10)</span></span>
<span><span class="co"># Ilist &lt;- vector("list", length = 10)</span></span>
<span><span class="co"># I2 &lt;- seq(.4, .1, length.out = 10)</span></span>
<span><span class="co"># for(i in seq_len(10)) {</span></span>
<span><span class="co">#      # Imat[i, ] &lt;- c(.5, I2[i]) </span></span>
<span><span class="co">#        Ilist[[i]] &lt;- c(.5, I2[i]) </span></span>
<span><span class="co">#      }</span></span>
<span><span class="co"># fun &lt;- function(I, p.vector, n = 500, nboot = 1000) {</span></span>
<span><span class="co">#     out &lt;- numeric(nboot)</span></span>
<span><span class="co">#     for(i in seq_len(nboot)) {</span></span>
<span><span class="co">#          res &lt;- rInput(n = n, par = p.vector, I = I, x0 = c(0, 0), 5001, F, </span></span>
<span><span class="co">#                                             random = T, debug = F)</span></span>
<span><span class="co">#              tmp &lt;- table(res@choice_RT[2,]) / n</span></span>
<span><span class="co">#              out[i] &lt;- tmp[1]</span></span>
<span><span class="co">#          }</span></span>
<span><span class="co">#        return(out)</span></span>
<span><span class="co"># }</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># ncore &lt;- length(Ilist)</span></span>
<span><span class="co"># out &lt;- parallel::mclapply(Ilist, fun, p.vector, n = 10000, nboot = 1000,</span></span>
<span><span class="co">#                           mc.cores = ncore) </span></span>
<span><span class="co"># save(out, file = "tests/6_LCA/data/dprob.rda")</span></span>
<span></span>
<span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">10</span>, ncol <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">I2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">.4</span>, <span class="fl">.1</span>, length.out <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">x0</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">tmp</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">out</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">tmp2</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="op">(</span>x <span class="op">=</span> <span class="va">out</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, I <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">I2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">x0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">tmp2</span>, <span class="va">x0</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">dprob</span> <span class="op">&lt;-</span> <span class="va">x0</span> </span>
<span><span class="va">dvline</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span>, y <span class="op">=</span> <span class="fl">60</span>, </span>
<span>                     I <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">I2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                     lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">binsize</span> <span class="op">&lt;-</span> <span class="fl">5</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">out</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">out</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>data <span class="op">=</span> <span class="va">dprob</span>, <span class="fu">aes</span><span class="op">(</span> x <span class="op">=</span> <span class="va">x</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="va">binsize</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>data <span class="op">=</span> <span class="va">dvline</span>, <span class="fu">aes</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text</span><span class="op">(</span>data <span class="op">=</span> <span class="va">dvline</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, label <span class="op">=</span> <span class="va">lab</span><span class="op">)</span>, </span>
<span>             size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="va">I</span><span class="op">~</span><span class="va">.</span>, scales <span class="op">=</span> <span class="st">"free_x"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">18</span><span class="op">)</span></span>
<span><span class="va">p2</span></span>
<span><span class="va">fig</span> <span class="op">&lt;-</span> <span class="fu">ggplotly</span><span class="op">(</span><span class="va">p2</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="images/LBA-2.png" style="width:75.0%" alt=""><p class="caption">The probability of chosen the first option</p>
</div>
<p>The larger the difference, the more probable the first accumulator is
chosen. The x facet shows the drift rate difference by subtracting the
value of the second accumulator from that of the first accumulator.
Because this model is driven only by an input drift rate, it is
unsurprising to see that the distributions are in Gaussian shape with a
mean of 0 and a standard deviation of <code>sqrt(dtovertau)</code>.</p>
</div>
<div class="section level4">
<h4 id="response-time-distributions">Response Time Distributions<a class="anchor" aria-label="anchor" href="#response-time-distributions"></a>
</h4>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## RT Distribution -----------</span></span>
<span><span class="va">plot_hist</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">binwidth</span> <span class="op">=</span> <span class="fl">.1</span>, <span class="va">cols</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"RT"</span>, <span class="st">"R"</span><span class="op">)</span>, <span class="va">print.fig</span> <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">upper</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">RT</span><span class="op">)</span> <span class="op">+</span> <span class="fl">3</span> <span class="op">*</span> <span class="va">binwidth</span></span>
<span>  <span class="va">bk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">upper</span>, by <span class="op">=</span> <span class="va">binwidth</span><span class="op">)</span></span>
<span>  <span class="va">dtmp</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span>, <span class="va">..cols</span><span class="op">]</span></span>
<span>  <span class="va">dA</span> <span class="op">&lt;-</span> <span class="va">dtmp</span><span class="op">[</span><span class="va">R</span> <span class="op">==</span> <span class="fl">1</span>, <span class="va">..cols</span><span class="op">]</span></span>
<span>  <span class="va">dB</span> <span class="op">&lt;-</span> <span class="va">dtmp</span><span class="op">[</span><span class="va">R</span> <span class="op">==</span> <span class="fl">2</span>, <span class="va">..cols</span><span class="op">]</span></span>
<span>  <span class="va">rtA</span> <span class="op">&lt;-</span> <span class="va">dA</span><span class="op">$</span><span class="va">RT</span></span>
<span>  <span class="va">rtB</span> <span class="op">&lt;-</span> <span class="va">dB</span><span class="op">$</span><span class="va">RT</span></span>
<span>  <span class="va">y0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">rtA</span>, breaks <span class="op">=</span> <span class="va">bk</span><span class="op">)</span></span>
<span>  <span class="va">y1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">rtB</span>, breaks <span class="op">=</span> <span class="va">bk</span><span class="op">)</span></span>
<span>  <span class="va">tmp0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"\\((.+),.*"</span>, <span class="st">"\\1"</span>, <span class="va">y0</span><span class="op">)</span> <span class="op">)</span>,</span>
<span>                upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"[^,]*,([^]]*)\\]"</span>, <span class="st">"\\1"</span>, <span class="va">y0</span><span class="op">)</span> <span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">tmp1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"\\((.+),.*"</span>, <span class="st">"\\1"</span>, <span class="va">y1</span><span class="op">)</span> <span class="op">)</span>,</span>
<span>                upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"[^,]*,([^]]*)\\]"</span>, <span class="st">"\\1"</span>, <span class="va">y1</span><span class="op">)</span> <span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">dA</span><span class="op">$</span><span class="va">mid</span> <span class="op">&lt;-</span> <span class="fl">.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">tmp0</span><span class="op">)</span></span>
<span>  <span class="va">dB</span><span class="op">$</span><span class="va">mid</span> <span class="op">&lt;-</span> <span class="fl">.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">tmp1</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">d1</span> <span class="op">&lt;-</span> <span class="va">dA</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span>y <span class="op">=</span> <span class="va">.N</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dtmp</span><span class="op">)</span><span class="op">)</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mid</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">d2</span> <span class="op">&lt;-</span> <span class="va">dB</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span>y <span class="op">=</span> <span class="va">.N</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dtmp</span><span class="op">)</span><span class="op">)</span>, <span class="fu">.</span><span class="op">(</span><span class="va">mid</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">d1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">d2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span></span>
<span>  <span class="va">d1</span><span class="op">$</span><span class="va">R</span> <span class="op">&lt;-</span> <span class="st">"1"</span></span>
<span>  <span class="va">d2</span><span class="op">$</span><span class="va">R</span> <span class="op">&lt;-</span> <span class="st">"2"</span></span>
<span>  <span class="va">tmp2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">d1</span>, <span class="va">d2</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">tmp2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_line</span><span class="op">(</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, colour <span class="op">=</span> <span class="va">R</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, colour <span class="op">=</span> <span class="va">R</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">xlab</span><span class="op">(</span><span class="st">"RT (s)"</span><span class="op">)</span> <span class="op">+</span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Proportion of trials"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_minimal</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">print.fig</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">tmp2</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">3000</span></span>
<span><span class="va">p.vector</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Z <span class="op">=</span> <span class="fl">2.8</span>, t0 <span class="op">=</span> <span class="fl">.2</span>, dtovertau <span class="op">=</span> <span class="fl">0.1</span>, dt <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">res5</span> <span class="op">&lt;-</span> <span class="fu">rInput</span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, par <span class="op">=</span> <span class="va">p.vector</span>, I <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">.25</span><span class="op">)</span>, x0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fl">5001</span>, <span class="cn">F</span>, </span>
<span>             random <span class="op">=</span> <span class="cn">T</span>, debug <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">dRT</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="op">(</span>RT <span class="op">=</span> <span class="va">res5</span><span class="op">@</span><span class="va">choice_RT</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">/</span><span class="fl">1000</span>, R <span class="op">=</span> </span>
<span>                   <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">res5</span><span class="op">@</span><span class="va">choice_RT</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/plot_hist.html">plot_hist</a></span><span class="op">(</span><span class="va">dRT</span>, binwidth <span class="op">=</span> <span class="fl">.09</span><span class="op">)</span></span>
<span></span>
<span><span class="va">x0</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">3000</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">1000</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">res5</span> <span class="op">&lt;-</span> <span class="fu">rInput</span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, par <span class="op">=</span> <span class="va">p.vector</span>, I <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">.25</span><span class="op">)</span>, x0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fl">5001</span>, <span class="cn">F</span>, </span>
<span>               random <span class="op">=</span> <span class="cn">T</span>, debug <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span>  <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="op">(</span>RT <span class="op">=</span> <span class="va">res5</span><span class="op">@</span><span class="va">choice_RT</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">/</span><span class="fl">1000</span>, R <span class="op">=</span> </span>
<span>                      <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">res5</span><span class="op">@</span><span class="va">choice_RT</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">tmp</span><span class="op">$</span><span class="va">boot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span></span>
<span>  <span class="va">x0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">x0</span>, <span class="va">tmp</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"RT"</span>, <span class="st">"R"</span><span class="op">)</span></span>
<span><span class="va">x0</span><span class="op">[</span><span class="va">boot</span> <span class="op">==</span> <span class="fl">1</span>, <span class="va">..cols</span><span class="op">]</span></span>
<span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">1e3</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/plot_hist.html">plot_hist</a></span><span class="op">(</span><span class="va">x0</span><span class="op">[</span><span class="va">boot</span> <span class="op">==</span> <span class="va">i</span>, <span class="va">..cols</span><span class="op">]</span>, binwidth <span class="op">=</span> <span class="fl">.09</span>, print.fig <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="va">tmp</span><span class="op">$</span><span class="va">boot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span></span>
<span>  <span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">tmp</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">x0</span>, <span class="va">x1</span>, file <span class="op">=</span> <span class="st">"tests/6_LCA/data/distribution.rda"</span><span class="op">)</span></span>
<span><span class="va">x1</span><span class="op">$</span><span class="va">Rboot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">x1</span><span class="op">$</span><span class="va">R</span>, <span class="va">x1</span><span class="op">$</span><span class="va">boot</span><span class="op">)</span></span>
<span><span class="va">dtmp</span> <span class="op">&lt;-</span> <span class="va">x1</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span>N <span class="op">=</span> <span class="va">.N</span>,</span>
<span>       y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, <span class="fu">.</span><span class="op">(</span><span class="va">x</span>, <span class="va">R</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">dtmp2</span> <span class="op">&lt;-</span> <span class="va">dtmp</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"R"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">dtmp2</span><span class="op">$</span><span class="va">Rboot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dtmp</span><span class="op">$</span><span class="va">R</span>, <span class="st">"Avg"</span><span class="op">)</span> </span>
<span><span class="co"># table(x1$x, x1$R)</span></span>
<span><span class="va">x1</span><span class="op">[</span><span class="va">boot</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">x1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, group <span class="op">=</span> <span class="va">Rboot</span>, colour <span class="op">=</span> <span class="va">R</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">1</span>, alpha <span class="op">=</span> <span class="fl">.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>data <span class="op">=</span> <span class="va">dtmp2</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, group <span class="op">=</span> <span class="va">Rboot</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># geom_point(aes(x = x, y = y, colour = R), size = 2) +</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"RT (s)"</span><span class="op">)</span> <span class="op">+</span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Proportion of trials"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> </span>
<span><span class="va">p3</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/png.html" class="external-link">png</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"vignettes/web_only/images/LBA-3.png"</span>, width <span class="op">=</span> <span class="fl">800</span>, height <span class="op">=</span> <span class="fl">600</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>To check numerical details on the figure, I use the wonderful
<code>plotly</code> package.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fig</span> <span class="op">&lt;-</span> <span class="fu">ggplotly</span><span class="op">(</span><span class="va">p3</span><span class="op">)</span></span>
<span><span class="va">fig</span></span></code></pre></div>
<div class="figure">
<img src="images/LBA-3.png" style="width:75.0%" alt=""><p class="caption">The choice RT distribution using inputs of .5 and
.3</p>
</div>
<p>In summary, this variant of model a pair of reasonable choice RT
distributions.</p>
</div>
</div>
<div class="section level3">
<h3 id="time-limited-paradigm">Time-limited Paradigm<a class="anchor" aria-label="anchor" href="#time-limited-paradigm"></a>
</h3>
<p>Time-limited paradigm refers to a task design in contrast to the
free-response paradigm. In a free-response paradigm, the response (time)
window is usually set far longer than most people’s slowest response
time or no time limit at all. In a time-limited paradigm, an observer is
given only a limited amount of time to make a choice. The time most
likely is not sufficient to make high confidence choice for many
people.</p>
<p>In the modelling process, this can be implemented in a very large
threshold and monitor which accumulator has garnered more evidence than
the others at each time step. The probability of choosing the first
accumulator eventually reach 1, given, e.g., 10000 steps.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## What is the choice probability ?</span></span>
<span><span class="va">rho</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">.4</span><span class="op">)</span></span>
<span><span class="va">x0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">p.vector</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Z <span class="op">=</span> <span class="fl">1000</span>, t0 <span class="op">=</span> <span class="fl">.2</span>, dtovertau <span class="op">=</span> <span class="fl">0.1</span>, dt <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">maxiter</span> <span class="op">&lt;-</span> <span class="fl">10000</span></span>
<span><span class="va">ncore</span> <span class="op">&lt;-</span> <span class="fl">6</span></span>
<span></span>
<span><span class="va">ntrial</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">5000</span>, <span class="va">ncore</span><span class="op">)</span></span>
<span><span class="va">nlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, length <span class="op">=</span> <span class="va">ncore</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">ncore</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>  <span class="va">nlist</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">ntrial</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">}</span></span>
<span><span class="co"># nlist</span></span>
<span></span>
<span><span class="va">fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">ntrial</span>, <span class="va">p.vector</span>, <span class="va">rho</span>, <span class="va">x0</span>, <span class="va">maxiter</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># cat(ntrial, "\n")</span></span>
<span>  <span class="va">res0</span> <span class="op">&lt;-</span> <span class="fu">rInput</span><span class="op">(</span>n <span class="op">=</span> <span class="va">ntrial</span>, par <span class="op">=</span> <span class="va">p.vector</span>, I <span class="op">=</span> <span class="va">rho</span>, x0 <span class="op">=</span> <span class="va">x0</span>, </span>
<span>               maxiter <span class="op">=</span> <span class="va">maxiter</span>, nonlinear <span class="op">=</span> <span class="cn">F</span>, random <span class="op">=</span> <span class="cn">T</span>, debug <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="va">maxiter</span><span class="op">+</span><span class="fl">1</span>, ncol <span class="op">=</span> <span class="va">ntrial</span><span class="op">)</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">ntrial</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">x1</span> <span class="op">&lt;-</span> <span class="va">res0</span><span class="op">@</span><span class="va">activation</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">maxiter</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span> , <span class="va">i</span><span class="op">]</span></span>
<span>    <span class="va">x2</span> <span class="op">&lt;-</span> <span class="va">res0</span><span class="op">@</span><span class="va">activation</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">maxiter</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span> , <span class="va">i</span><span class="op">]</span></span>
<span>    <span class="va">out</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">x1</span> <span class="op">&gt;</span> <span class="va">x2</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="figure">
<img src="images/LBA-4.png" style="width:75.0%" alt=""><p class="caption">The choice RT distribution using inputs of .5 and
.3</p>
</div>
</div>
<div class="section level3">
<h3 id="recovery-studies">Recovery Studies<a class="anchor" aria-label="anchor" href="#recovery-studies"></a>
</h3>
<p>I used a generic method, probability density approximation to derive
model likelihoods and used maximum likelihood estimation, instead of
Bayesian inference, to conduct the recovery studies. The latter also
uses likelihood functions, but usually uses different method to propose
candidate parameters and estimate estimation intervals. The former is
enough to provide answers regarding whether:</p>
<ol style="list-style-type: decimal">
<li>The approximated likelihood function is precise enough to recover
parameters in the case of LCA and reduced LCA models.</li>
<li>The model itself is recoverable in the range of parameters that we
are interested in.</li>
</ol>
<p>I implement a process model based on the previous simplified LCA
model (a cousin of the LBA model), called
<code>rInput_internal</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pkg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ggplot2"</span>, <span class="st">'data.table'</span>, <span class="st">'pedxing'</span>, <span class="st">'rbenchmark'</span>, <span class="st">'nloptr'</span>, <span class="st">'plotly'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">pkg</span>, <span class="va">require</span>, character.only <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">setwd</a></span><span class="op">(</span><span class="st">"/media/yslin/Tui/projects/pedxing/"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pal</span> <span class="op">&lt;-</span> <span class="fu">Manu</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Manu/man/get_pal.html" class="external-link">get_pal</a></span><span class="op">(</span><span class="st">"Kaka"</span><span class="op">)</span></span>
<span><span class="va">get_sll</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">x</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">)</span> <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">x</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">)</span> <span class="op">)</span> <span class="op">}</span></span></code></pre></div>
<div class="section level4">
<h4 id="drift-rate-model-2">Drift-rate model<a class="anchor" aria-label="anchor" href="#drift-rate-model-2"></a>
</h4>
<p>The data set I used to evaluate the recovery is a simulated data with
only 100 trials.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p.vector</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Z <span class="op">=</span> <span class="fl">2.8</span>, t0 <span class="op">=</span> <span class="fl">.2</span>, dtovertau <span class="op">=</span> <span class="fl">0.1</span>, dt <span class="op">=</span> <span class="fl">10</span><span class="op">/</span><span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">rho</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">.35</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">tmp0</span> <span class="op">&lt;-</span> <span class="fu">rInput_internal</span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, par <span class="op">=</span> <span class="va">p.vector</span>, I <span class="op">=</span> <span class="va">rho</span>, x0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fl">5001</span>,</span>
<span>                       nonlinear <span class="op">=</span> <span class="cn">F</span>, random <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="op">(</span>RT <span class="op">=</span> <span class="va">tmp0</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span>, R <span class="op">=</span> <span class="va">tmp0</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat_tmp</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="op">(</span>RT <span class="op">=</span> <span class="va">tmp0</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span>, R <span class="op">=</span> <span class="va">tmp0</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/png.html" class="external-link">png</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"vignettes/web_only/images/LBA-5.png"</span>, width <span class="op">=</span> <span class="fl">800</span>, height <span class="op">=</span> <span class="fl">600</span><span class="op">)</span></span>
<span><span class="fu"><a href="../../reference/plot_hist.html">plot_hist</a></span><span class="op">(</span><span class="va">dat_tmp</span>, binwidth <span class="op">=</span> <span class="fl">.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="images/LBA-5.png" style="width:50.0%" alt=""><p class="caption">The choice-RT data</p>
</div>
<p>I did a number of preliminary model fitting to gauge of how well the
<code>subplex</code> routine and in particular this one implemented in
<code>sbplx</code> performs. By linking the newly written
<code>rInput_internal</code> function with a <code>spdf</code> routine
in the pda.cpp in the <code>ggdmc</code>, I then have a simulated dLBA
function.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">get_sll</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">x</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">)</span> <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">x</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">)</span> <span class="op">)</span> <span class="op">}</span></span>
<span></span>
<span><span class="va">tmp1</span> <span class="op">&lt;-</span> <span class="fu">dLBA</span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">RT</span>, <span class="va">dat</span><span class="op">$</span><span class="va">R</span>, nsim <span class="op">=</span> <span class="fl">10000</span>, par <span class="op">=</span> <span class="va">p.vector</span>, I <span class="op">=</span> <span class="va">rho</span>, </span>
<span>             x0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fl">5001</span>, <span class="cn">F</span>, <span class="cn">T</span>, <span class="cn">F</span><span class="op">)</span></span>
<span><span class="op">-</span><span class="fu">get_sll</span><span class="op">(</span><span class="va">tmp1</span><span class="op">)</span></span>
<span><span class="co">##  63.25775</span></span></code></pre></div>
<p>The ideal negative log-likelihood is 63. If a minimisation routine
can find the parameters, optimisation around the data, it should return
a negative log-likelihood close to this value.</p>
<p>The LCA model has a non-negative constraint, so I apply it to all
parameters, restricting the parameter space. This was suggested also in
the early LCA paper <span class="citation">(Usher and McClelland
2001)</span>.</p>
<p>The following shows one example run.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## dLBA ---------------------------</span></span>
<span><span class="va">fun</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="va">rho</span>, <span class="va">data</span>, <span class="va">debug</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span>  <span class="co"># cat(" ", rho, "\n")</span></span>
<span>  <span class="va">test_rho</span> <span class="op">&lt;&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">test_rho</span>, <span class="va">rho</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html" class="external-link">setorder</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">R</span>, <span class="va">RT</span><span class="op">)</span></span>
<span>  <span class="va">RT</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">RT</span></span>
<span>  <span class="va">R</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">R</span> </span>
<span>  <span class="va">p.vector</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Z <span class="op">=</span> <span class="va">rho</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, t0 <span class="op">=</span> <span class="fl">.2</span>, dtovertau <span class="op">=</span> <span class="fl">0.1</span>, dt <span class="op">=</span> <span class="fl">10</span><span class="op">/</span><span class="fl">1000</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu">dLBA</span><span class="op">(</span><span class="va">RT</span>, <span class="va">R</span>, nsim <span class="op">=</span> <span class="fl">10000</span>, par <span class="op">=</span> <span class="va">p.vector</span>, I <span class="op">=</span> <span class="va">rho</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, x0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>               <span class="fl">5001</span>, <span class="cn">F</span>, <span class="cn">T</span>, <span class="va">debug</span><span class="op">)</span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu">get_sll</span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span></span>
<span>  <span class="va">test_nll</span> <span class="op">&lt;&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">test_nll</span>, <span class="va">out</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">nmaxit</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="va">test_rho</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">test_nll</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">sbplx</span><span class="op">(</span>x0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, fn <span class="op">=</span> <span class="va">fun</span>, </span>
<span>             lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">dat</span>, debug <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                 control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>maxeval <span class="op">=</span> <span class="va">nmaxit</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dresult</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span> true <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">rho</span>, <span class="va">p.vector</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="op">-</span><span class="fu">get_sll</span><span class="op">(</span><span class="va">tmp1</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                       estm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">par</span>, <span class="va">test_nll</span><span class="op">[</span><span class="va">fit</span><span class="op">$</span><span class="va">iter</span><span class="op">]</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="va">dresult</span></span>
<span><span class="co">#        true       estm</span></span>
<span><span class="co"># 1:  0.50000  0.4831009</span></span>
<span><span class="co"># 2:  0.35000  0.1935556</span></span>
<span><span class="co"># 3:  2.80000  2.5724348</span></span>
<span><span class="co"># 4: 63.99076 63.6569213</span></span></code></pre></div>
<p>Before proceeding to fit the model to the data, I conducted a
<em>parameter survey</em> <a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Apparently, a similar, but precisely speaking not
identical, practice calls sensitive analysis &lt;span class="citation"&gt;(&lt;span&gt;“Sensitivity Analysis”&lt;/span&gt; 2022)&lt;/span&gt;.&lt;/p&gt;'><sup>2</sup></a>. I calculated model likelihoods by
constructing a grid of a pair of drift rates for the two accumulators.
The range goes from -2 to 2, using a step of 0.051. The purpose of
surveying values below 0 is that in my preliminary tests on fitting the
model to a simulated data set, I found that there is a fair percentage
(about 25 %) in a 100-run bootstrapping test that the estimated drift
rates were near 0, given that I set of lower bound at 0 for all
parameters and knew the true values of the two drift rates are 0.5 and
0.2.</p>
<p>The result is summarised in the following figure. The orange circles
shows that the two discontinuous regions return higher likelihoods than
the purple circles close to the true values. Two features in the
discontinuous regions stands out: one of the drift rates is negative in
the orange circles and one of the drift rates close to 0 in the green
circles. Note the green circles represent the parameters resulting in
lower likelihoods than the purple circles, which are the parameters very
close the one resulting in maximum likelihood.</p>
<p>It is likely that a parameter search routine might still end up
reporting a best estimate by sampling one of the green circles in the
two discontinuous regions, because of the jump from one of the low
likelihood points near edge of the concave surface to a relatively very
high likelihood point in the discontinuous regions. The PDA method
increases the likelihood of such a search scenario when an attempt of
the simplex to the real maximum likelihood region returns low likelihood
because of the noisy likelihood estimation and thereby guides the search
process away from the maximum likelihood region (see a similar problem
in Bayesian inference in <span class="citation">(Holmes
2015)</span>.</p>
<p>In summary, I resolve this problem by setting a lower bound of 0 in
the parameter search routine and employ five parallel searches. This is
in line with the theoretical assumption of the LCA model, and most
race-style accumulation models, which assume positive drift rates. We
employed five parallel searches and set a zero lower bound to the
parameter search routine to resolve this problem.</p>
<div class="figure">
<img src="images/linear_include_negative.png" style="width:75.0%" alt=""><p class="caption">Parameter space</p>
</div>
<div class="section level5">
<h5 id="start-the-searches">Start the searches<a class="anchor" aria-label="anchor" href="#start-the-searches"></a>
</h5>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">run_fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">i</span>, <span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># i &lt;- 1</span></span>
<span>  <span class="co"># n &lt;- 100</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">i</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">10</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"step "</span>, <span class="va">i</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  </span>
<span>  </span>
<span>  <span class="va">fun</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="va">par</span>, <span class="va">data</span>, <span class="va">debug</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">test_par</span> <span class="op">&lt;&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">test_par</span>, <span class="va">par</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html" class="external-link">setorder</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">R</span>, <span class="va">RT</span><span class="op">)</span></span>
<span>    <span class="va">RT</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">RT</span></span>
<span>    <span class="va">R</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">R</span> </span>
<span>    <span class="va">p.vector</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Z <span class="op">=</span> <span class="va">par</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, t0 <span class="op">=</span> <span class="fl">.2</span>, dtovertau <span class="op">=</span> <span class="fl">0.1</span>, dt <span class="op">=</span> <span class="fl">10</span><span class="op">/</span><span class="fl">1000</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu">dLBA</span><span class="op">(</span><span class="va">RT</span>, <span class="va">R</span>, nsim <span class="op">=</span> <span class="fl">10000</span>, par <span class="op">=</span> <span class="va">p.vector</span>, I <span class="op">=</span> <span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, x0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>                <span class="fl">5001</span>, <span class="cn">F</span>, <span class="cn">T</span>, <span class="va">debug</span><span class="op">)</span></span>
<span>    <span class="va">out</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu">get_sll</span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span></span>
<span>    <span class="va">test_nll</span> <span class="op">&lt;&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">test_nll</span>, <span class="va">out</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span>    </span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">p.vector</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Z <span class="op">=</span> <span class="fl">2.8</span>, t0 <span class="op">=</span> <span class="fl">.2</span>, dtovertau <span class="op">=</span> <span class="fl">0.1</span>, dt <span class="op">=</span> <span class="fl">10</span><span class="op">/</span><span class="fl">1000</span><span class="op">)</span></span>
<span>  <span class="va">rho</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">.35</span><span class="op">)</span></span>
<span>  <span class="va">tmp0</span> <span class="op">&lt;-</span> <span class="fu">rInput_internal</span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, par <span class="op">=</span> <span class="va">p.vector</span>, I <span class="op">=</span> <span class="va">rho</span>, x0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fl">5001</span>,</span>
<span>                        nonlinear <span class="op">=</span> <span class="cn">F</span>, random <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span>  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span>RT <span class="op">=</span> <span class="va">tmp0</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span>, R <span class="op">=</span> <span class="va">tmp0</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">npar</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span>  </span>
<span>  <span class="va">x0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">npar</span><span class="op">)</span></span>
<span>  <span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">npar</span><span class="op">)</span></span>
<span>  <span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">npar</span><span class="op">)</span></span>
<span>  <span class="va">x3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">npar</span><span class="op">)</span></span>
<span>  <span class="va">x4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">npar</span><span class="op">)</span></span>
<span>  <span class="va">lower</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">npar</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">test_par</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>  <span class="va">test_nll</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>  <span class="va">fit0</span> <span class="op">&lt;-</span> <span class="fu">sbplx</span><span class="op">(</span>x0 <span class="op">=</span> <span class="va">x0</span>, fn <span class="op">=</span> <span class="va">fun</span>, </span>
<span>               lower <span class="op">=</span> <span class="va">lower</span>, data <span class="op">=</span> <span class="va">dat</span>, debug <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="va">res0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">fit0</span>, parameter <span class="op">=</span> <span class="va">test_par</span>, nll <span class="op">=</span> <span class="va">test_nll</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">test_par</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>  <span class="va">test_nll</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>  <span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu">sbplx</span><span class="op">(</span>x0 <span class="op">=</span> <span class="va">x1</span>, fn <span class="op">=</span> <span class="va">fun</span>, </span>
<span>                lower <span class="op">=</span> <span class="va">lower</span>, data <span class="op">=</span> <span class="va">dat</span>, debug <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="va">res1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">fit1</span>, parameter <span class="op">=</span> <span class="va">test_par</span>, nll <span class="op">=</span> <span class="va">test_nll</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">test_par</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>  <span class="va">test_nll</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>  <span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu">sbplx</span><span class="op">(</span>x0 <span class="op">=</span> <span class="va">x2</span>, fn <span class="op">=</span> <span class="va">fun</span>, </span>
<span>                lower <span class="op">=</span> <span class="va">lower</span>, data <span class="op">=</span> <span class="va">dat</span>, debug <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="va">res2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">fit2</span>, parameter <span class="op">=</span> <span class="va">test_par</span>, nll <span class="op">=</span> <span class="va">test_nll</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">test_par</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>  <span class="va">test_nll</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>  <span class="va">fit3</span> <span class="op">&lt;-</span> <span class="fu">sbplx</span><span class="op">(</span>x0 <span class="op">=</span> <span class="va">x3</span>, fn <span class="op">=</span> <span class="va">fun</span>, </span>
<span>                lower <span class="op">=</span> <span class="va">lower</span>, data <span class="op">=</span> <span class="va">dat</span>, debug <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="va">res3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">fit3</span>, parameter <span class="op">=</span> <span class="va">test_par</span>, nll <span class="op">=</span> <span class="va">test_nll</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">test_par</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>  <span class="va">test_nll</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>  <span class="va">fit4</span> <span class="op">&lt;-</span> <span class="fu">sbplx</span><span class="op">(</span>x0 <span class="op">=</span> <span class="va">x4</span>, fn <span class="op">=</span> <span class="va">fun</span>, </span>
<span>                lower <span class="op">=</span> <span class="va">lower</span>, data <span class="op">=</span> <span class="va">dat</span>, debug <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="va">res4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">fit4</span>, parameter <span class="op">=</span> <span class="va">test_par</span>, nll <span class="op">=</span> <span class="va">test_nll</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">fits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">fit0</span>, <span class="va">fit1</span>, <span class="va">fit2</span>, <span class="va">fit3</span>, <span class="va">fit4</span><span class="op">)</span> </span>
<span>  <span class="va">idxmin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">fit0</span><span class="op">$</span><span class="va">value</span>, <span class="va">fit1</span><span class="op">$</span><span class="va">value</span>, <span class="va">fit2</span><span class="op">$</span><span class="va">value</span>, <span class="va">fit3</span><span class="op">$</span><span class="va">value</span>, <span class="va">fit4</span><span class="op">$</span><span class="va">value</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">fits</span><span class="op">[[</span><span class="va">idxmin</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">ncore</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">t0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span>  <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/mclapply.html" class="external-link">mclapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, <span class="va">run_fun</span>, n <span class="op">=</span> <span class="fl">100</span>, mc.cores <span class="op">=</span> <span class="va">ncore</span><span class="op">)</span></span>
<span><span class="va">t1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">res</span>, file <span class="op">=</span> <span class="st">"tests/6_LCA/data/test_dLBA_v9.rda"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">true</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">.35</span>, <span class="fl">2.8</span><span class="op">)</span></span>
<span><span class="va">nll</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">parameter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">100</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">difference</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">100</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co"># i &lt;- 1</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">parameter</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">par</span></span>
<span>  <span class="va">difference</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">par</span> <span class="op">-</span> <span class="va">true</span></span>
<span>  <span class="va">nll</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">value</span></span>
<span>  </span>
<span>  <span class="va">p.vector</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Z <span class="op">=</span> <span class="fl">2.8</span>, t0 <span class="op">=</span> <span class="fl">.2</span>, dtovertau <span class="op">=</span> <span class="fl">0.1</span>, dt <span class="op">=</span> <span class="fl">10</span><span class="op">/</span><span class="fl">1000</span><span class="op">)</span></span>
<span>  <span class="va">p.vector</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># save(res, parameter, difference, nll, file = "tests/6_LCA/data/test_dLBA_v9.rda")</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"tests/6_LCA/data/test_dLBA_v9.rda"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dpar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="va">parameter</span>, nll <span class="op">=</span> <span class="va">nll</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dpar</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rho1"</span>, <span class="st">"rho2"</span>, <span class="st">"Z"</span>, <span class="st">"nll_subplex"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">dpar</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">dtmp1</span> <span class="op">&lt;-</span> <span class="va">dpar</span><span class="op">[</span><span class="va">nll_subplex</span> <span class="op">&gt;</span> <span class="fl">75.2</span><span class="op">]</span></span>
<span><span class="va">dtmp2</span> <span class="op">&lt;-</span> <span class="va">dpar</span><span class="op">[</span><span class="va">nll_subplex</span> <span class="op">&lt;=</span> <span class="fl">75.2</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># The relative standing is kept. No estimates report that rho1 is greater</span></span>
<span><span class="co"># than rho2, in line with the true values</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span> <span class="va">dpar</span><span class="op">$</span><span class="va">rho1</span> <span class="op">&gt;</span> <span class="va">dpar</span><span class="op">$</span><span class="va">rho2</span> <span class="op">)</span></span>
<span><span class="co"># 0</span></span>
<span></span>
<span><span class="co"># Only two estimates amongst 100 attempts were from the edges of the </span></span>
<span><span class="co"># surface </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">dtmp2</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#    rho1 rho2    Z nll_subplex</span></span>
<span><span class="co"># 1: 0.05 0.02 1.16       95.54</span></span>
<span><span class="co"># 2: 0.14 0.04 1.16       75.43</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dtmp1</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dpar</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dtmp2</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dpar</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span> <span class="va">dtmp2</span><span class="op">$</span><span class="va">rho1</span> <span class="op">&gt;</span> <span class="va">dtmp2</span><span class="op">$</span><span class="va">rho2</span> <span class="op">)</span></span>
<span><span class="co"># 98</span></span>
<span></span>
<span><span class="fu">psych</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/psych/man/describe.html" class="external-link">describe</a></span><span class="op">(</span><span class="va">dtmp1</span><span class="op">$</span><span class="va">nll_subplex</span><span class="op">)</span></span>
<span><span class="co">#    mean    sd median trimmed   mad   min   max range skew kurtosis    se</span></span>
<span><span class="co">#  50.93   9.55  51.33   51.06   9.7 30.29 75.12 44.83 -0.02    -0.54 0.96</span></span>
<span></span>
<span><span class="va">bw1</span> <span class="op">&lt;-</span> <span class="fl">3</span><span class="op">*</span><span class="fu">plotrix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotrix/man/std.error.html" class="external-link">std.error</a></span><span class="op">(</span><span class="va">dtmp2</span><span class="op">$</span><span class="va">rho1</span><span class="op">)</span></span>
<span><span class="va">bw2</span> <span class="op">&lt;-</span> <span class="fl">3</span><span class="op">*</span><span class="fu">plotrix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotrix/man/std.error.html" class="external-link">std.error</a></span><span class="op">(</span><span class="va">dtmp2</span><span class="op">$</span><span class="va">rho2</span><span class="op">)</span></span>
<span><span class="va">bw3</span> <span class="op">&lt;-</span> <span class="fl">3</span><span class="op">*</span><span class="fu">plotrix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotrix/man/std.error.html" class="external-link">std.error</a></span><span class="op">(</span><span class="va">dtmp2</span><span class="op">$</span><span class="va">Z</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>data <span class="op">=</span> <span class="va">d1</span><span class="op">[</span><span class="va">gp</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="va">bw1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>data <span class="op">=</span> <span class="va">d1</span><span class="op">[</span><span class="va">gp</span> <span class="op">==</span> <span class="fl">2</span><span class="op">]</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="va">bw2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>data <span class="op">=</span> <span class="va">d1</span><span class="op">[</span><span class="va">gp</span> <span class="op">==</span> <span class="fl">3</span><span class="op">]</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="va">bw3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>data <span class="op">=</span> <span class="va">dvline</span>, <span class="fu">aes</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">x</span>, color <span class="op">=</span> <span class="va">gp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="va">.</span><span class="op">~</span><span class="va">gp</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># png(file = "vignettes/web_only/images/dLBA-1.png", width = 800, height = 600)</span></span>
<span><span class="co"># p</span></span>
<span><span class="co"># dev.off()</span></span></code></pre></div>
<div class="figure">
<img src="images/dLBA-1.png" style="width:75.0%" alt=""><p class="caption">Parameter space</p>
</div>
<p>The estimates are not perfect and there is a 2% chance that it
returns parameters resulting in high likelihoods, but not as high as
maximum. Nevertheless, the bootstrapped distribution do suggest that</p>
<ol style="list-style-type: decimal">
<li>There is a good chance that the estimate of drift rate 1 is larger
than that of drift rate 2, and the threshold estimate is close to the
true value.</li>
</ol>
<p>To sum up, now I have a basic LCA formulation. I can then add a
leakage term to see how it affects the model prediction and to see if it
can make it something that we can use in a task where manifest signal
suppression is a good hypothesis.</p>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="programming-note">Programming Note<a class="anchor" aria-label="anchor" href="#programming-note"></a>
</h2>
<ul>
<li>I used five packages to support the code in this vignette.
<code>pedxing</code> is a customised package associated with the
manuscript of this work. It is going to be hosted on <a href="https://www.github.com/yxlin" class="external-link">my Github</a>.</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pkg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ggplot2"</span>, <span class="st">'data.table'</span>, <span class="st">'pedxing'</span>, <span class="st">'rbenchmark'</span>, <span class="st">'plotly'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">pkg</span>, <span class="va">require</span>, character.only <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">setwd</a></span><span class="op">(</span><span class="st">"/media/yslin/Tui/projects/pedxing/"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="reference">Reference<a class="anchor" aria-label="anchor" href="#reference"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-bogaczPhysicsOptimalDecision2006" class="csl-entry">
Bogacz, Rafal, Eric Brown, Jeff Moehlis, Philip Holmes, and Jonathan D.
Cohen. 2006. <span>“The Physics of Optimal Decision Making: A Formal
Analysis of Models of Performance in Two-Alternative Forced-Choice
Tasks.”</span> <em>Psychological Review</em> 113 (4): 700–765. <a href="https://doi.org/10.1037/0033-295X.113.4.700" class="external-link">https://doi.org/10.1037/0033-295X.113.4.700</a>.
</div>
<div id="ref-brownSimplestCompleteModel2008" class="csl-entry">
Brown, Scott D, and Andrew Heathcote. 2008. <span>“The Simplest Complete
Model of Choice Response Time: Linear Ballistic Accumulation.”</span>
<em>Cognitive Psychology</em> 57 (3): 153–78. <a href="https://doi.org/doi:10.1016/j.cogpsych.2007.12.002" class="external-link">https://doi.org/doi:10.1016/j.cogpsych.2007.12.002</a>.
</div>
<div id="ref-fellerIntroductionProbabilityTheory2008" class="csl-entry">
Feller, William. 2008. <em>An <span>Introduction</span> to
<span>Probability Theory</span> and <span>Its Applications</span></em>.
Second. Vol. 1. <span>New York, NY</span>: <span>Wiley</span>.
</div>
<div id="ref-holmesPracticalGuideProbability2015" class="csl-entry">
Holmes, William R. 2015. <span>“A Practical Guide to the
<span>Probability Density Approximation</span> (<span>PDA</span>) with
Improved Implementation and Error Characterization.”</span> <em>Journal
of Mathematical Psychology</em> 68–69 (October): 13–24. <a href="https://doi.org/10.1016/j.jmp.2015.08.006" class="external-link">https://doi.org/10.1016/j.jmp.2015.08.006</a>.
</div>
<div id="ref-holmesBayesianAnalysisPiecewise2018a" class="csl-entry">
Holmes, William R., and Jennifer S. Trueblood. 2018. <span>“Bayesian
Analysis of the Piecewise Diffusion Decision Model.”</span> <em>Behavior
Research Methods</em> 50 (2): 730–43. <a href="https://doi.org/10.3758/s13428-017-0901-y" class="external-link">https://doi.org/10.3758/s13428-017-0901-y</a>.
</div>
<div id="ref-mileticParameterRecoveryLeaky2017" class="csl-entry">
Miletić, Steven, Brandon M. Turner, Birte U. Forstmann, and Leendert van
Maanen. 2017. <span>“Parameter Recovery for the <span>Leaky Competing
Accumulator</span> Model.”</span> <em>Journal of Mathematical
Psychology</em> 76 (February): 25–50. <a href="https://doi.org/10.1016/j.jmp.2016.12.001" class="external-link">https://doi.org/10.1016/j.jmp.2016.12.001</a>.
</div>
<div id="ref-SensitivityAnalysis2022" class="csl-entry">
<span>“Sensitivity Analysis.”</span> 2022. <em>Wikipedia</em>,
September.
</div>
<div id="ref-teodorescuDisentanglingDecisionModels2013" class="csl-entry">
Teodorescu, Andrei R., and Marius Usher. 2013. <span>“Disentangling
Decision Models: <span>From</span> Independence to Competition.”</span>
<em>Psychological Review</em> 120 (1): 1–38. <a href="https://doi.org/10.1037/a0030776" class="external-link">https://doi.org/10.1037/a0030776</a>.
</div>
<div id="ref-tsetsosUsingTimeVaryingEvidence2012a" class="csl-entry">
Tsetsos, Konstantinos, Juan Gao, James L. McClelland, and Marius Usher.
2012. <span>“Using <span>Time-Varying Evidence</span> to <span>Test
Models</span> of <span>Decision Dynamics</span>: <span>Bounded
Diffusion</span> Vs. The <span>Leaky Competing Accumulator
Model</span>.”</span> <em>Frontiers in Neuroscience</em> 6. <a href="https://doi.org/10.3389/fnins.2012.00079" class="external-link">https://doi.org/10.3389/fnins.2012.00079</a>.
</div>
<div id="ref-tsetsosPreferenceReversalMultiattribute2010a" class="csl-entry">
Tsetsos, Konstantinos, Marius Usher, and Nick Chater. 2010.
<span>“Preference Reversal in Multiattribute Choice.”</span>
<em>Psychological Review</em> 117 (4): 1275–91. <a href="https://doi.org/10.1037/a0020580" class="external-link">https://doi.org/10.1037/a0020580</a>.
</div>
<div id="ref-usherTimeCoursePerceptual2001" class="csl-entry">
Usher, M., and J. L. McClelland. 2001. <span>“The Time Course of
Perceptual Choice: The Leaky, Competing Accumulator Model.”</span>
<em>Psychological Review</em> 108 (3): 550–92. <a href="https://doi.org/10.1037/0033-295X.108.3.550" class="external-link">https://doi.org/10.1037/0033-295X.108.3.550</a>.
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Yi-Shin Lin.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
